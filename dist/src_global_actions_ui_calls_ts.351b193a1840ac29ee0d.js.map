{"version":3,"file":"src_global_actions_ui_calls_ts.351b193a1840ac29ee0d.js","mappings":"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","sources":["webpack://telegram-t/./src/global/actions/api/chats.ts","webpack://telegram-t/./src/global/actions/ui/calls.ts","webpack://telegram-t/./src/global/reducers/calls.ts"],"sourcesContent":["import type {\n  ApiChat, ApiChatFolder, ApiChatlistExportedInvite,\n  ApiChatMember, ApiError, ApiMissingInvitedUser,\n  ApiTopic,\n  LinkContext,\n} from '../../../api/types';\nimport type { RequiredGlobalActions } from '../../index';\nimport type {\n  ActionReturnType, GlobalState, TabArgs,\n} from '../../types';\nimport { MAIN_THREAD_ID } from '../../../api/types';\nimport {\n  ChatCreationProgress,\n  type ChatListType,\n  ManagementProgress,\n  NewChatMembersProgress,\n  SettingsScreens,\n  type ThreadId,\n} from '../../../types';\n\nimport {\n  ALL_FOLDER_ID,\n  ARCHIVED_FOLDER_ID,\n  CHAT_LIST_LOAD_SLICE,\n  DEBUG,\n  GLOBAL_SUGGESTED_CHANNELS_ID,\n  RE_TG_LINK,\n  SAVED_FOLDER_ID,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  TME_WEB_DOMAINS,\n  TMP_CHAT_ID,\n  TOP_CHAT_MESSAGES_PRELOAD_LIMIT,\n  TOPICS_SLICE,\n  TOPICS_SLICE_SECOND_LOAD,\n} from '../../../config';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { formatShareText, processDeepLink } from '../../../util/deeplink';\nimport { isDeepLink } from '../../../util/deepLinkParser';\nimport { isUserId } from '../../../util/entities/ids';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { getOrderedIds } from '../../../util/folderManager';\nimport {\n  buildCollectionByKey, omit, pick, unique,\n} from '../../../util/iteratees';\nimport { isLocalMessageId } from '../../../util/keys/messageKey';\nimport * as langProvider from '../../../util/oldLangProvider';\nimport { debounce, pause, throttle } from '../../../util/schedulers';\nimport { extractCurrentThemeParams } from '../../../util/themeStyle';\nimport { callApi } from '../../../api/gramjs';\nimport {\n  getIsSavedDialog,\n  isChatArchived,\n  isChatBasicGroup,\n  isChatChannel,\n  isChatMonoforum,\n  isChatSuperGroup,\n  isUserBot,\n} from '../../helpers';\nimport {\n  addActionHandler, getGlobal, setGlobal,\n} from '../../index';\nimport {\n  addChatListIds,\n  addChatMembers,\n  addChats,\n  addMessages,\n  addNotifyExceptions,\n  addSimilarBots,\n  addUsers,\n  addUserStatuses,\n  deleteChatMessages,\n  deletePeerPhoto,\n  deleteTopic,\n  leaveChat,\n  removeChatFromChatLists,\n  replaceChatFullInfo,\n  replaceChatListIds,\n  replaceChatListLoadingParameters,\n  replaceMessages,\n  replaceNotifyExceptions,\n  replaceSimilarChannels,\n  replaceThreadParam,\n  replaceUserStatuses,\n  toggleSimilarChannels,\n  updateChat,\n  updateChatFullInfo,\n  updateChatLastMessageId,\n  updateChatListSecondaryInfo,\n  updateChats,\n  updateChatsLastMessageId,\n  updateListedTopicIds,\n  updateManagementProgress,\n  updateMissingInvitedUsers,\n  updatePeerFullInfo,\n  updateThread,\n  updateThreadInfo,\n  updateTopic,\n  updateTopics,\n  updateUser,\n  updateUsers,\n} from '../../reducers';\nimport { updateGroupCall } from '../../reducers/calls';\nimport { updateTabState } from '../../reducers/tabs';\nimport {\n  selectChat,\n  selectChatByUsername,\n  selectChatFolder,\n  selectChatFullInfo,\n  selectChatLastMessageId,\n  selectChatListLoadingParameters,\n  selectChatListType,\n  selectChatMessages,\n  selectCurrentChat,\n  selectCurrentMessageList,\n  selectDraft,\n  selectIsChatPinned,\n  selectIsChatWithSelf,\n  selectIsCurrentUserFrozen,\n  selectLastServiceNotification,\n  selectPeer,\n  selectPeerFullInfo,\n  selectSimilarChannelIds,\n  selectStickerSet,\n  selectSupportChat,\n  selectTabState,\n  selectThread,\n  selectThreadInfo,\n  selectTopic,\n  selectTopics,\n  selectTopicsInfo,\n  selectUser,\n  selectUserByPhoneNumber,\n} from '../../selectors';\nimport { selectGroupCall } from '../../selectors/calls';\nimport { selectCurrentLimit } from '../../selectors/limits';\n\nconst TOP_CHAT_MESSAGES_PRELOAD_INTERVAL = 100;\nconst INFINITE_LOOP_MARKER = 100;\n\nconst CHATLIST_LIMIT_ERROR_LIST = new Set([\n  'FILTERS_TOO_MUCH',\n  'CHATLISTS_TOO_MUCH',\n  'INVITES_TOO_MUCH',\n]);\n\nconst runThrottledForLoadTopChats = throttle((cb) => cb(), 3000, true);\nconst runDebouncedForLoadFullChat = debounce((cb) => cb(), 500, false, true);\n\naddActionHandler('preloadTopChatMessages', async (global, actions): Promise<void> => {\n  const preloadedChatIds = new Set<string>();\n\n  for (let i = 0; i < TOP_CHAT_MESSAGES_PRELOAD_LIMIT; i++) {\n    await pause(TOP_CHAT_MESSAGES_PRELOAD_INTERVAL);\n\n    global = getGlobal();\n    const currentChatIds = Object.values(global.byTabId)\n\n      .map(({ id: tabId }) => selectCurrentMessageList(global, tabId)?.chatId)\n      .filter(Boolean);\n\n    const folderAllOrderedIds = getOrderedIds(ALL_FOLDER_ID);\n    const nextChatId = folderAllOrderedIds?.find((id) => !currentChatIds.includes(id) && !preloadedChatIds.has(id));\n    if (!nextChatId) {\n      return;\n    }\n\n    preloadedChatIds.add(nextChatId);\n\n    actions.loadViewportMessages({ chatId: nextChatId, threadId: MAIN_THREAD_ID, tabId: getCurrentTabId() });\n  }\n});\n\nfunction abortChatRequests(chatId: string, threadId?: ThreadId) {\n  callApi('abortChatRequests', { chatId, threadId });\n}\n\nfunction abortChatRequestsForCurrentChat<T extends GlobalState>(\n  global: T, newChatId?: string, newThreadId?: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const currentMessageList = selectCurrentMessageList(global, tabId);\n  const currentChatId = currentMessageList?.chatId;\n  const currentThreadId = currentMessageList?.threadId;\n\n  if (currentChatId && (currentChatId !== newChatId || currentThreadId !== newThreadId)) {\n    const [isChatOpened, isThreadOpened] = Object.values(global.byTabId)\n      .reduce(([accHasChatOpened, accHasThreadOpened], { id: otherTabId }) => {\n        if (otherTabId === tabId || (accHasChatOpened && accHasThreadOpened)) {\n          return [accHasChatOpened, accHasThreadOpened];\n        }\n\n        const otherMessageList = selectCurrentMessageList(global, otherTabId);\n        const isSameChat = otherMessageList?.chatId === currentChatId;\n        const isSameThread = isSameChat && otherMessageList?.threadId === currentThreadId;\n\n        return [accHasChatOpened || isSameChat, accHasThreadOpened || isSameThread];\n      }, [currentChatId === newChatId, false]);\n\n    const shouldAbortChatRequests = !isChatOpened || !isThreadOpened;\n\n    if (shouldAbortChatRequests) {\n      abortChatRequests(currentChatId, isChatOpened ? currentThreadId : undefined);\n    }\n  }\n}\n\naddActionHandler('openChat', (global, actions, payload): ActionReturnType => {\n  const {\n    id, type, noForumTopicPanel, shouldReplaceHistory, shouldReplaceLast,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  actions.processOpenChatOrThread({\n    chatId: id,\n    type,\n    threadId: MAIN_THREAD_ID,\n    noForumTopicPanel,\n    shouldReplaceHistory,\n    shouldReplaceLast,\n    tabId,\n  });\n\n  abortChatRequestsForCurrentChat(global, id, MAIN_THREAD_ID, tabId);\n\n  if (!id || id === TMP_CHAT_ID) {\n    return;\n  }\n\n  const chat = selectChat(global, id);\n\n  if (chat?.hasUnreadMark) {\n    actions.markChatRead({ id });\n  }\n\n  const isChatOnlySummary = !selectChatLastMessageId(global, id);\n\n  if (!chat) {\n    if (selectIsChatWithSelf(global, id)) {\n      void callApi('fetchChat', { type: 'self' });\n    } else {\n      const user = selectUser(global, id);\n      if (user) {\n        void callApi('fetchChat', { type: 'user', user });\n      }\n    }\n  } else if (isChatOnlySummary && !chat.isMin) {\n    actions.requestChatUpdate({ chatId: id });\n  }\n});\n\naddActionHandler('openSavedDialog', (global, actions, payload): ActionReturnType => {\n  const { chatId, tabId = getCurrentTabId(), ...otherParams } = payload;\n\n  actions.openThread({\n    chatId: global.currentUserId!,\n    threadId: chatId,\n    tabId,\n    ...otherParams,\n  });\n});\n\naddActionHandler('openThread', async (global, actions, payload): Promise<void> => {\n  const {\n    type, isComments, noForumTopicPanel, shouldReplaceHistory, shouldReplaceLast,\n    focusMessageId,\n    tabId = getCurrentTabId(),\n  } = payload;\n  let { chatId } = payload;\n  let threadId: ThreadId | undefined;\n  let loadingChatId: string;\n  let loadingThreadId: ThreadId;\n\n  if (!isComments) {\n    loadingChatId = payload.chatId;\n    threadId = payload.threadId;\n    loadingThreadId = threadId;\n\n    const originalChat = selectChat(global, loadingChatId);\n    if (threadId === MAIN_THREAD_ID) {\n      actions.openChat({\n        id: chatId,\n        type,\n        noForumTopicPanel,\n        shouldReplaceHistory,\n        shouldReplaceLast,\n        tabId,\n      });\n      return;\n    } else if (originalChat?.isForum || (chatId && getIsSavedDialog(chatId, threadId, global.currentUserId))) {\n      actions.processOpenChatOrThread({\n        chatId,\n        type,\n        threadId,\n        isComments,\n        noForumTopicPanel,\n        shouldReplaceHistory,\n        shouldReplaceLast,\n        tabId,\n      });\n      return;\n    }\n  } else {\n    const { originChannelId, originMessageId } = payload;\n\n    loadingChatId = originChannelId;\n    loadingThreadId = originMessageId;\n  }\n\n  const chat = selectChat(global, loadingChatId);\n  const threadInfo = selectThreadInfo(global, loadingChatId, loadingThreadId);\n  const thread = selectThread(global, loadingChatId, loadingThreadId);\n  if (!chat) return;\n\n  abortChatRequestsForCurrentChat(global, loadingChatId, loadingThreadId, tabId);\n\n  if (chatId\n    && threadInfo?.threadId\n    && (isComments || (thread?.listedIds?.length && thread.listedIds.includes(Number(threadInfo.threadId))))) {\n    global = updateTabState(global, {\n      loadingThread: undefined,\n    }, tabId);\n    setGlobal(global);\n    actions.processOpenChatOrThread({\n      chatId,\n      type,\n      threadId: threadInfo.threadId,\n      isComments,\n      noForumTopicPanel,\n      shouldReplaceHistory,\n      shouldReplaceLast,\n      tabId,\n    });\n    return;\n  }\n\n  let { loadingThread } = selectTabState(global, tabId);\n  if (loadingThread) {\n    abortChatRequests(loadingThread.loadingChatId, loadingThread.loadingMessageId);\n  }\n\n  global = updateTabState(global, {\n    loadingThread: {\n      loadingChatId,\n      loadingMessageId: Number(loadingThreadId),\n    },\n  }, tabId);\n  setGlobal(global);\n\n  const openPreviousChat = () => {\n    const currentGlobal = getGlobal();\n    if (isComments\n      || selectCurrentMessageList(currentGlobal, tabId)?.chatId !== loadingChatId\n      || selectCurrentMessageList(currentGlobal, tabId)?.threadId !== loadingThreadId) {\n      return;\n    }\n    actions.openPreviousChat({ tabId });\n  };\n\n  if (!isComments) {\n    actions.processOpenChatOrThread({\n      chatId,\n      type,\n      threadId: threadId!,\n      tabId,\n      isComments,\n      noForumTopicPanel,\n      shouldReplaceHistory,\n      shouldReplaceLast,\n    });\n  }\n\n  const result = selectIsCurrentUserFrozen(global) ? undefined\n    : await callApi('fetchDiscussionMessage', {\n      chat: selectChat(global, loadingChatId)!,\n      messageId: Number(loadingThreadId),\n    });\n\n  global = getGlobal();\n  loadingThread = selectTabState(global, tabId).loadingThread;\n  if (loadingThread?.loadingChatId !== loadingChatId || loadingThread?.loadingMessageId !== loadingThreadId) {\n    openPreviousChat();\n    return;\n  }\n\n  if (!result) {\n    global = updateTabState(global, {\n      loadingThread: undefined,\n    }, tabId);\n    setGlobal(global);\n\n    actions.showNotification({\n      message: langProvider.oldTranslate(isComments ? 'ChannelPostDeleted' : 'lng_message_not_found'),\n      tabId,\n    });\n\n    openPreviousChat();\n    return;\n  }\n\n  threadId ??= result.threadId;\n  chatId ??= result.chatId;\n\n  if (!chatId) {\n    openPreviousChat();\n    return;\n  }\n\n  global = getGlobal();\n  global = addMessages(global, result.messages);\n  if (isComments) {\n    global = updateThreadInfo(global, loadingChatId, loadingThreadId, {\n      threadId,\n    });\n\n    const lastMessageId = threadInfo?.lastMessageId !== undefined ? threadInfo.lastMessageId\n      : threadInfo?.messagesCount === 0 ? result.threadId : undefined;\n\n    global = updateThreadInfo(global, chatId, threadId, {\n      isCommentsInfo: false,\n      threadId,\n      chatId,\n      fromChannelId: loadingChatId,\n      fromMessageId: loadingThreadId,\n      lastMessageId,\n      ...(threadInfo\n        && pick(threadInfo, ['messagesCount', 'lastReadInboxMessageId', 'recentReplierIds'])\n      ),\n    });\n  }\n  global = updateThread(global, chatId, threadId, {\n    firstMessageId: result.firstMessageId,\n  });\n  setGlobal(global);\n\n  if (focusMessageId) {\n    actions.focusMessage({\n      chatId,\n      threadId,\n      messageId: focusMessageId,\n      tabId,\n    });\n  }\n\n  actions.loadViewportMessages({\n    chatId,\n    threadId,\n    tabId,\n    onError: () => {\n      global = getGlobal();\n      global = updateTabState(global, {\n        loadingThread: undefined,\n      }, tabId);\n      setGlobal(global);\n\n      actions.showNotification({\n        message: langProvider.oldTranslate('Group.ErrorAccessDenied'),\n        tabId,\n      });\n    },\n    onLoaded: () => {\n      global = getGlobal();\n      loadingThread = selectTabState(global, tabId).loadingThread;\n      if (loadingThread?.loadingChatId !== loadingChatId || loadingThread?.loadingMessageId !== loadingThreadId) {\n        return;\n      }\n\n      global = updateTabState(global, {\n        loadingThread: undefined,\n      }, tabId);\n      setGlobal(global);\n\n      actions.processOpenChatOrThread({\n        chatId,\n        type,\n        threadId,\n        tabId,\n        isComments,\n        noForumTopicPanel,\n        shouldReplaceHistory,\n        shouldReplaceLast,\n      });\n    },\n  });\n});\n\naddActionHandler('openLinkedChat', async (global, actions, payload): Promise<void> => {\n  const { id, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, id);\n  if (!chat) {\n    return;\n  }\n\n  const chatFullInfo = await callApi('fetchFullChat', chat);\n\n  if (chatFullInfo?.fullInfo?.linkedChatId) {\n    actions.openChat({ id: chatFullInfo.fullInfo.linkedChatId, tabId });\n  }\n});\n\naddActionHandler('openSupportChat', async (global, actions, payload): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  const chat = selectSupportChat(global);\n  if (chat) {\n    actions.openChat({ id: chat.id, shouldReplaceHistory: true, tabId });\n    return;\n  }\n\n  actions.openChat({ id: TMP_CHAT_ID, shouldReplaceHistory: true, tabId });\n\n  const result = await callApi('fetchChat', { type: 'support' });\n  if (result) {\n    actions.openChat({ id: result.chatId, shouldReplaceHistory: true, tabId });\n  }\n});\n\naddActionHandler('loadAllChats', async (global, actions, payload): Promise<void> => {\n  const { whenFirstBatchDone } = payload;\n  const listType = payload.listType;\n  let isCallbackFired = false;\n  let i = 0;\n\n  while (!global.chats.isFullyLoaded[listType]) {\n    if (i++ >= INFINITE_LOOP_MARKER) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.error('`actions/loadAllChats`: Infinite loop detected');\n      }\n\n      return;\n    }\n\n    global = getGlobal();\n\n    if (global.connectionState !== 'connectionStateReady' || global.auth.state !== 'authorizationStateReady') {\n      return;\n    }\n\n    await loadChats(\n      listType,\n      true,\n    );\n\n    if (!isCallbackFired) {\n      await whenFirstBatchDone?.();\n      isCallbackFired = true;\n    }\n\n    global = getGlobal();\n  }\n});\n\naddActionHandler('loadPinnedDialogs', async (global, actions, payload): Promise<void> => {\n  const {\n    listType,\n  } = payload;\n\n  const result = await callApi('fetchPinnedDialogs', { listType });\n  if (!result) return;\n\n  const { dialogIds, messages, chats, users } = result;\n\n  global = getGlobal();\n  global = updateChats(global, buildCollectionByKey(chats, 'id'));\n  global = updateUsers(global, buildCollectionByKey(users, 'id'));\n  global = replaceMessages(global, messages);\n\n  global = {\n    ...global,\n    chats: {\n      ...global.chats,\n      orderedPinnedIds: {\n        ...global.chats.orderedPinnedIds,\n        [listType]: dialogIds.length ? dialogIds : undefined,\n      },\n    },\n  };\n\n  setGlobal(global);\n});\n\naddActionHandler('loadFullChat', (global, actions, payload): ActionReturnType => {\n  const {\n    chatId, force, withPhotos,\n  } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const loadChat = async () => {\n    await loadFullChat(global, actions, chat);\n    if (withPhotos) {\n      actions.loadMoreProfilePhotos({ peerId: chatId, shouldInvalidateCache: true });\n    }\n  };\n\n  if (force) {\n    void loadChat();\n  } else {\n    runDebouncedForLoadFullChat(loadChat);\n  }\n});\n\naddActionHandler('invalidateFullInfo', (global, actions, payload): ActionReturnType => {\n  const { peerId } = payload;\n\n  const isUser = isUserId(peerId);\n\n  if (isUser) {\n    return {\n      ...global,\n      users: {\n        ...global.users,\n        fullInfoById: omit(global.users.fullInfoById, [peerId]),\n      },\n    };\n  }\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      fullInfoById: omit(global.chats.fullInfoById, [peerId]),\n    },\n  };\n});\n\naddActionHandler('loadTopChats', (): ActionReturnType => {\n  runThrottledForLoadTopChats(() => {\n    loadChats('active', undefined, true);\n    loadChats('archived', undefined, true);\n  });\n});\n\naddActionHandler('requestChatUpdate', (global, actions, payload): ActionReturnType => {\n  const { chatId } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  void callApi('requestChatUpdate', {\n    chat,\n    ...(chatId === SERVICE_NOTIFICATIONS_USER_ID && {\n      lastLocalMessage: selectLastServiceNotification(global)?.message,\n    }),\n  });\n});\n\naddActionHandler('requestSavedDialogUpdate', async (global, actions, payload): Promise<void> => {\n  const { chatId } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const result = await callApi('fetchMessages', {\n    chat,\n    isSavedDialog: true,\n    limit: 1,\n  });\n\n  if (!result) return;\n\n  global = getGlobal();\n\n  global = addMessages(global, result.messages);\n\n  if (result.messages.length) {\n    global = updateChatLastMessageId(global, chatId, result.messages[0].id, 'saved');\n    global = addChatListIds(global, 'saved', [chatId]);\n\n    setGlobal(global);\n  } else {\n    global = removeChatFromChatLists(global, chatId, 'saved');\n\n    setGlobal(global);\n\n    Object.values(global.byTabId).forEach(({ id: tabId }) => {\n      const currentMessageList = selectCurrentMessageList(global, tabId);\n      if (!currentMessageList) return;\n      const { chatId: tabChatId, threadId } = currentMessageList;\n\n      if (selectIsChatWithSelf(global, tabChatId) && threadId === chatId) {\n        actions.openChat({ id: undefined, tabId });\n      }\n    });\n  }\n});\n\naddActionHandler('updateChatMutedState', (global, actions, payload): ActionReturnType => {\n  const { chatId, mutedUntil } = payload;\n\n  if (selectIsCurrentUserFrozen(global)) {\n    actions.openFrozenAccountModal({ tabId: getCurrentTabId() });\n    return;\n  }\n\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  void callApi('updateChatNotifySettings', { chat, settings: { mutedUntil } });\n});\n\naddActionHandler('updateChatSilentPosting', (global, actions, payload): ActionReturnType => {\n  const { chatId, isEnabled } = payload;\n\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  void callApi('updateChatNotifySettings', { chat, settings: { isSilentPosting: isEnabled } });\n});\n\naddActionHandler('updateTopicMutedState', (global, actions, payload): ActionReturnType => {\n  const {\n    chatId, topicId, mutedUntil,\n  } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  void callApi('updateTopicMutedState', {\n    chat, topicId, mutedUntil,\n  });\n});\n\naddActionHandler('createChannel', async (global, actions, payload): Promise<void> => {\n  const {\n    title, about, photo, memberIds, discussionChannelId, tabId = getCurrentTabId(),\n  } = payload;\n  const isChannel = 'isChannel' in payload ? payload.isChannel : undefined;\n  const isSuperGroup = 'isSuperGroup' in payload ? payload.isSuperGroup : undefined;\n\n  const users = memberIds?.map((id) => selectUser(global, id))\n    .filter(Boolean);\n\n  global = updateTabState(global, {\n    chatCreation: {\n      progress: ChatCreationProgress.InProgress,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  let createdChannel: ApiChat | undefined;\n  let missingInvitedUsers: ApiMissingInvitedUser[] | undefined;\n  try {\n    const result = await callApi('createChannel', {\n      title,\n      about,\n      users,\n      isBroadcast: isChannel,\n      isMegagroup: isSuperGroup,\n    });\n    createdChannel = result?.channel;\n    missingInvitedUsers = result?.missingUsers;\n  } catch (error) {\n    global = getGlobal();\n\n    global = updateTabState(global, {\n      chatCreation: {\n        progress: ChatCreationProgress.Error,\n      },\n    }, tabId);\n\n    setGlobal(global);\n\n    if ((error as ApiError).message === 'CHANNELS_TOO_MUCH') {\n      actions.openLimitReachedModal({ limit: 'channels', tabId });\n    } else {\n      actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n    }\n  }\n\n  if (!createdChannel) {\n    return;\n  }\n\n  const { id: channelId, accessHash } = createdChannel;\n\n  global = getGlobal();\n  global = updateChat(global, channelId, createdChannel);\n  global = updateTabState(global, {\n    chatCreation: {\n      ...selectTabState(global, tabId).chatCreation,\n      progress: createdChannel ? ChatCreationProgress.Complete : ChatCreationProgress.Error,\n    },\n  }, tabId);\n  setGlobal(global);\n  if (discussionChannelId && channelId) {\n    actions.linkDiscussionGroup({\n      channelId: discussionChannelId,\n      chatId: channelId,\n      tabId,\n    });\n  }\n  actions.openChat({ id: channelId, shouldReplaceHistory: true, tabId });\n\n  if (missingInvitedUsers) {\n    global = getGlobal();\n    global = updateMissingInvitedUsers(global, channelId, missingInvitedUsers, tabId);\n    setGlobal(global);\n  }\n\n  if (channelId && accessHash && photo) {\n    await callApi('editChatPhoto', { chatId: channelId, accessHash, photo });\n  }\n});\n\naddActionHandler('joinChannel', async (global, actions, payload): Promise<void> => {\n  const { chatId, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const { id: channelId, accessHash } = chat;\n\n  if (!(channelId && accessHash)) {\n    return;\n  }\n\n  try {\n    await callApi('joinChannel', { channelId, accessHash });\n  } catch (error) {\n    if ((error as ApiError).message === 'CHANNELS_TOO_MUCH') {\n      actions.openLimitReachedModal({ limit: 'channels', tabId });\n    } else {\n      actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n    }\n  }\n});\n\naddActionHandler('deleteChatUser', (global, actions, payload): ActionReturnType => {\n  const {\n    chatId, userId, shouldRevokeHistory, tabId = getCurrentTabId(),\n  } = payload;\n  const chat = selectChat(global, chatId);\n  const user = selectUser(global, userId);\n  if (!chat || !user) {\n    return;\n  }\n\n  global = leaveChat(global, chatId);\n  setGlobal(global);\n\n  if (selectCurrentMessageList(global, tabId)?.chatId === chatId) {\n    actions.openChat({ id: undefined, tabId });\n  }\n\n  void callApi('deleteChatUser', { chat, user, shouldRevokeHistory });\n});\n\naddActionHandler('deleteChat', (global, actions, payload): ActionReturnType => {\n  const { chatId, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  global = leaveChat(global, chatId);\n  setGlobal(global);\n\n  if (selectCurrentMessageList(global, tabId)?.chatId === chatId) {\n    actions.openChat({ id: undefined, tabId });\n  }\n\n  void callApi('deleteChat', { chatId: chat.id });\n});\n\naddActionHandler('leaveChannel', async (global, actions, payload): Promise<void> => {\n  const { chatId, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  global = leaveChat(global, chatId);\n  setGlobal(global);\n\n  if (selectCurrentMessageList(global, tabId)?.chatId === chatId) {\n    actions.openChat({ id: undefined, tabId });\n  }\n\n  const { id: channelId, accessHash } = chat;\n  if (channelId && accessHash) {\n    await callApi('leaveChannel', { channelId, accessHash });\n    global = getGlobal();\n    const chatMessages = selectChatMessages(global, chatId);\n    const localMessageIds = Object.keys(chatMessages).map(Number).filter(isLocalMessageId);\n    global = deleteChatMessages(global, chatId, localMessageIds);\n    setGlobal(global);\n  }\n});\n\naddActionHandler('deleteChannel', (global, actions, payload): ActionReturnType => {\n  const { chatId, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  global = leaveChat(global, chatId);\n  setGlobal(global);\n\n  if (selectCurrentMessageList(global, tabId)?.chatId === chatId) {\n    actions.openChat({ id: undefined, tabId });\n  }\n\n  const { id: channelId, accessHash } = chat;\n  if (channelId && accessHash) {\n    void callApi('deleteChannel', { channelId, accessHash });\n  }\n});\n\naddActionHandler('createGroupChat', async (global, actions, payload): Promise<void> => {\n  const {\n    title, memberIds, photo, tabId = getCurrentTabId(),\n  } = payload;\n  const users = (memberIds)\n    .map((id) => selectUser(global, id))\n    .filter(Boolean);\n\n  global = updateTabState(global, {\n    chatCreation: {\n      progress: ChatCreationProgress.InProgress,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  try {\n    const { chat: createdChat, missingUsers } = await callApi('createGroupChat', {\n      title,\n      users,\n    }) ?? {};\n\n    if (!createdChat) {\n      return;\n    }\n\n    const { id: chatId } = createdChat;\n\n    global = getGlobal();\n    global = updateChat(global, chatId, createdChat);\n    global = updateTabState(global, {\n      chatCreation: {\n        ...selectTabState(global, tabId).chatCreation,\n        progress: createdChat ? ChatCreationProgress.Complete : ChatCreationProgress.Error,\n      },\n    }, tabId);\n    setGlobal(global);\n    actions.openChat({\n      id: chatId,\n      shouldReplaceHistory: true,\n      tabId,\n    });\n\n    if (missingUsers) {\n      global = getGlobal();\n      global = updateMissingInvitedUsers(global, chatId, missingUsers, tabId);\n      setGlobal(global);\n    }\n\n    if (chatId && photo) {\n      await callApi('editChatPhoto', {\n        chatId,\n        photo,\n      });\n    }\n  } catch (err) {\n    if ((err as ApiError).message === 'USERS_TOO_FEW') {\n      global = getGlobal();\n      global = updateTabState(global, {\n        chatCreation: {\n          ...selectTabState(global, tabId).chatCreation,\n          progress: ChatCreationProgress.Error,\n          error: 'CreateGroupError',\n        },\n      }, tabId);\n      setGlobal(global);\n    }\n  }\n});\n\naddActionHandler('toggleChatPinned', (global, actions, payload): ActionReturnType => {\n  const { id, folderId, tabId = getCurrentTabId() } = payload;\n\n  if (selectIsCurrentUserFrozen(global)) {\n    actions.openFrozenAccountModal({ tabId });\n    return;\n  }\n  const chat = selectChat(global, id);\n  if (!chat) {\n    return;\n  }\n\n  const limit = selectCurrentLimit(global, 'dialogFolderPinned');\n\n  if (folderId) {\n    const folder = selectChatFolder(global, folderId);\n    if (folder) {\n      const shouldBePinned = !selectIsChatPinned(global, id, folderId);\n\n      const { pinnedChatIds, includedChatIds } = folder;\n      const newPinnedIds = shouldBePinned\n        ? [id, ...(pinnedChatIds || [])]\n        : (pinnedChatIds || []).filter((pinnedId) => pinnedId !== id);\n\n      // With both Pin and Unpin we need to re-add a user to the included group\n      const newIncludedChatIds = [id, ...includedChatIds];\n\n      void callApi('editChatFolder', {\n        id: folderId,\n        folderUpdate: {\n          ...folder,\n          pinnedChatIds: newPinnedIds,\n          includedChatIds: newIncludedChatIds,\n        },\n      });\n    }\n  } else {\n    const listType = selectChatListType(global, id);\n    const isPinned = selectIsChatPinned(global, id, listType === 'archived' ? ARCHIVED_FOLDER_ID : undefined);\n\n    const ids = global.chats.orderedPinnedIds[listType === 'archived' ? 'archived' : 'active'];\n    if ((ids?.length || 0) >= limit && !isPinned) {\n      actions.openLimitReachedModal({\n        limit: 'dialogFolderPinned',\n        tabId,\n      });\n      return;\n    }\n    void callApi('toggleChatPinned', { chat, shouldBePinned: !isPinned });\n  }\n});\n\naddActionHandler('toggleChatArchived', (global, actions, payload): ActionReturnType => {\n  const { id } = payload;\n\n  if (selectIsCurrentUserFrozen(global)) {\n    actions.openFrozenAccountModal({ tabId: getCurrentTabId() });\n    return;\n  }\n\n  const chat = selectChat(global, id);\n  if (chat) {\n    void callApi('toggleChatArchived', {\n      chat,\n      folderId: isChatArchived(chat) ? 0 : ARCHIVED_FOLDER_ID,\n    });\n  }\n});\n\naddActionHandler('toggleSavedDialogPinned', (global, actions, payload): ActionReturnType => {\n  const { id, tabId = getCurrentTabId() } = payload;\n\n  if (selectIsCurrentUserFrozen(global)) {\n    actions.openFrozenAccountModal({ tabId });\n    return;\n  }\n\n  const chat = selectChat(global, id);\n  if (!chat) {\n    return;\n  }\n\n  const limit = selectCurrentLimit(global, 'savedDialogsPinned');\n\n  const isPinned = selectIsChatPinned(global, id, SAVED_FOLDER_ID);\n\n  const ids = global.chats.orderedPinnedIds.saved;\n  if ((ids?.length || 0) >= limit && !isPinned) {\n    actions.openLimitReachedModal({\n      limit: 'savedDialogsPinned',\n      tabId,\n    });\n    return;\n  }\n  void callApi('toggleSavedDialogPinned', { chat, shouldBePinned: !isPinned });\n});\n\naddActionHandler('loadChatFolders', async (global): Promise<void> => {\n  const chatFolders = await callApi('fetchChatFolders');\n\n  if (chatFolders) {\n    global = getGlobal();\n\n    global = {\n      ...global,\n      chatFolders: {\n        ...global.chatFolders,\n        ...chatFolders,\n      },\n    };\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadRecommendedChatFolders', async (global): Promise<void> => {\n  const recommendedChatFolders = await callApi('fetchRecommendedChatFolders');\n\n  if (recommendedChatFolders) {\n    global = getGlobal();\n\n    global = {\n      ...global,\n      chatFolders: {\n        ...global.chatFolders,\n        recommended: recommendedChatFolders,\n      },\n    };\n    setGlobal(global);\n  }\n});\n\naddActionHandler('toggleDialogFilterTags', async (global, actions, payload): Promise<void> => {\n  const { isEnabled } = payload;\n\n  const result = await callApi('toggleDialogFilterTags', isEnabled);\n\n  if (result) {\n    global = getGlobal();\n    global = {\n      ...global,\n      chatFolders: {\n        ...global.chatFolders,\n        areTagsEnabled: isEnabled,\n      },\n    };\n    setGlobal(global);\n  }\n});\n\naddActionHandler('editChatFolders', (global, actions, payload): ActionReturnType => {\n  const {\n    chatId, idsToRemove, idsToAdd, tabId = getCurrentTabId(),\n  } = payload;\n  const limit = selectCurrentLimit(global, 'dialogFiltersChats');\n\n  const isLimitReached = idsToAdd\n    .some((id) => selectChatFolder(global, id).includedChatIds.length >= limit);\n  if (isLimitReached) {\n    actions.openLimitReachedModal({ limit: 'dialogFiltersChats', tabId });\n    return;\n  }\n\n  idsToRemove.forEach((id) => {\n    const folder = selectChatFolder(global, id);\n    if (folder) {\n      callApi('editChatFolder', {\n        id,\n        folderUpdate: {\n          ...folder,\n          pinnedChatIds: folder.pinnedChatIds?.filter((pinnedId) => pinnedId !== chatId),\n          includedChatIds: folder.includedChatIds.filter((includedId) => includedId !== chatId),\n        },\n      });\n    }\n  });\n\n  idsToAdd.forEach((id) => {\n    const folder = selectChatFolder(global, id);\n    if (folder) {\n      callApi('editChatFolder', {\n        id,\n        folderUpdate: {\n          ...folder,\n          includedChatIds: folder.includedChatIds.concat(chatId),\n        },\n      });\n    }\n  });\n});\n\naddActionHandler('editChatFolder', (global, actions, payload): ActionReturnType => {\n  const { id, folderUpdate } = payload;\n  const folder = selectChatFolder(global, id);\n\n  if (folder) {\n    void callApi('editChatFolder', {\n      id,\n      folderUpdate: {\n        id,\n        emoticon: folder.emoticon,\n        pinnedChatIds: folder.pinnedChatIds,\n        ...folderUpdate,\n      },\n    });\n  }\n});\n\naddActionHandler('addChatFolder', async (global, actions, payload): Promise<void> => {\n  const { folder, tabId = getCurrentTabId() } = payload;\n  const { orderedIds, byId } = global.chatFolders;\n\n  const limit = selectCurrentLimit(global, 'dialogFilters');\n  if (Object.keys(byId).length >= limit) {\n    actions.openLimitReachedModal({\n      limit: 'dialogFilters',\n      tabId,\n    });\n    return;\n  }\n\n  const maxId = Math.max(...(orderedIds || []), ARCHIVED_FOLDER_ID);\n\n  // Clear fields from recommended folders\n  const { id: recommendedId, description, ...newFolder } = folder;\n\n  const newId = maxId + 1;\n  const folderUpdate = {\n    id: newId,\n    ...newFolder,\n  };\n  await callApi('editChatFolder', {\n    id: newId,\n    folderUpdate,\n  });\n\n  // Update called from the above `callApi` is throttled, but we need to apply changes immediately\n  actions.apiUpdate({\n    '@type': 'updateChatFolder',\n    id: newId,\n    folder: folderUpdate,\n  });\n\n  actions.requestNextFoldersAction({\n    foldersAction: {\n      type: 'setFolderId',\n      payload: maxId + 1,\n    },\n    tabId,\n  });\n\n  if (!description) {\n    return;\n  }\n\n  global = getGlobal();\n  const { recommended } = global.chatFolders;\n\n  if (recommended) {\n    global = {\n      ...global,\n      chatFolders: {\n        ...global.chatFolders,\n        recommended: recommended.filter(({ id }) => id !== recommendedId),\n      },\n    };\n    setGlobal(global);\n  }\n});\n\naddActionHandler('sortChatFolders', async (global, actions, payload): Promise<void> => {\n  const { folderIds } = payload;\n\n  const result = await callApi('sortChatFolders', folderIds);\n  if (result) {\n    global = getGlobal();\n    global = {\n      ...global,\n      chatFolders: {\n        ...global.chatFolders,\n        orderedIds: folderIds,\n      },\n    };\n    setGlobal(global);\n  }\n});\n\naddActionHandler('deleteChatFolder', async (global, actions, payload): Promise<void> => {\n  const { id } = payload;\n  const folder = selectChatFolder(global, id);\n\n  if (folder) {\n    await callApi('deleteChatFolder', id);\n  }\n});\n\naddActionHandler('markChatUnread', (global, actions, payload): ActionReturnType => {\n  const { id } = payload;\n\n  if (selectIsCurrentUserFrozen(global)) {\n    actions.openFrozenAccountModal({ tabId: getCurrentTabId() });\n    return;\n  }\n  const chat = selectChat(global, id);\n  if (!chat) return;\n  void callApi('toggleDialogUnread', {\n    chat,\n    hasUnreadMark: !chat.hasUnreadMark,\n  });\n});\n\naddActionHandler('markChatMessagesRead', async (global, actions, payload): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n  const { id } = payload;\n\n  if (selectIsCurrentUserFrozen(global)) {\n    actions.openFrozenAccountModal({ tabId: getCurrentTabId() });\n    return;\n  }\n\n  const chat = selectChat(global, id);\n  if (!chat) return;\n  if (!chat.isForum) {\n    await callApi('markMessageListRead', { chat, threadId: MAIN_THREAD_ID });\n    actions.readAllMentions({ chatId: id });\n    actions.readAllReactions({ chatId: id });\n    if (chat.hasUnreadMark) {\n      actions.markChatRead({ id });\n    }\n    return;\n  }\n\n  let hasMoreTopics = true;\n  let lastTopic: ApiTopic | undefined;\n  let processedCount = 0;\n\n  while (hasMoreTopics) {\n    const result = await callApi('fetchTopics', {\n      chat, offsetDate: lastTopic?.date, offsetTopicId: lastTopic?.id, offsetId: lastTopic?.lastMessageId, limit: 100,\n    });\n\n    if (!result?.topics?.length) return;\n\n    result.topics.forEach((topic) => {\n      if (!topic.unreadCount && !topic.unreadMentionsCount && !topic.unreadReactionsCount) return;\n      actions.markTopicRead({ chatId: id, topicId: topic.id });\n    });\n\n    lastTopic = result.topics[result.topics.length - 1];\n    processedCount += result.topics.length;\n    if (result.count <= processedCount) {\n      hasMoreTopics = false;\n    }\n  }\n});\n\naddActionHandler('markChatRead', (global, actions, payload): ActionReturnType => {\n  const { id } = payload;\n  const chat = selectChat(global, id);\n  if (!chat) return;\n\n  callApi('toggleDialogUnread', {\n    chat,\n    hasUnreadMark: !chat.hasUnreadMark,\n  });\n});\n\naddActionHandler('markTopicRead', (global, actions, payload): ActionReturnType => {\n  if (selectIsCurrentUserFrozen(global)) return;\n  const { chatId, topicId } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  const topic = selectTopic(global, chatId, topicId);\n\n  const lastTopicMessageId = topic?.lastMessageId;\n  if (!lastTopicMessageId) return;\n\n  void callApi('markMessageListRead', {\n    chat,\n    threadId: topicId,\n    maxId: lastTopicMessageId,\n  });\n  actions.readAllMentions({ chatId, threadId: topicId });\n  actions.readAllReactions({ chatId, threadId: topicId });\n\n  global = getGlobal();\n  global = updateTopic(global, chatId, topicId, {\n    unreadCount: 0,\n  });\n  global = updateThreadInfo(global, chatId, topicId, {\n    lastReadInboxMessageId: lastTopicMessageId,\n  });\n  setGlobal(global);\n});\n\naddActionHandler('checkChatInvite', async (global, actions, payload): Promise<void> => {\n  const { hash, tabId = getCurrentTabId() } = payload;\n\n  const result = await callApi('checkChatInvite', hash);\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n\n  if (result.users) {\n    global = addUsers(global, buildCollectionByKey(result.users, 'id'));\n  }\n\n  if (result.chat) {\n    global = addChats(global, buildCollectionByKey([result.chat], 'id'));\n    setGlobal(global);\n    actions.openChat({ id: result.chat.id, tabId });\n    return;\n  }\n\n  if (result.invite.subscriptionFormId) {\n    global = updateTabState(global, {\n      starsPayment: {\n        inputInvoice: {\n          type: 'chatInviteSubscription',\n          hash,\n        },\n        subscriptionInfo: result.invite,\n        status: 'pending',\n      },\n    }, tabId);\n    setGlobal(global);\n    return;\n  }\n\n  global = updateTabState(global, {\n    chatInviteModal: {\n      hash,\n      inviteInfo: result.invite,\n    },\n  }, tabId);\n  setGlobal(global);\n});\n\naddActionHandler('openChatByPhoneNumber', async (global, actions, payload): Promise<void> => {\n  const {\n    phoneNumber, startAttach, attach, text, tabId = getCurrentTabId(),\n  } = payload;\n\n  // Open temporary empty chat to make the click response feel faster\n  actions.openChat({ id: TMP_CHAT_ID, tabId });\n\n  const chat = await fetchChatByPhoneNumber(global, phoneNumber);\n  if (!chat) {\n    actions.openPreviousChat({ tabId });\n    actions.showNotification({\n      message: langProvider.oldTranslate('lng_username_by_phone_not_found').replace('{phone}', phoneNumber),\n      tabId,\n    });\n    return;\n  }\n\n  if (text) {\n    actions.openChatWithDraft({ chatId: chat.id, text: { text }, tabId });\n  } else {\n    actions.openChat({ id: chat.id, tabId });\n  }\n\n  if (attach) {\n    global = getGlobal();\n    openAttachMenuFromLink(global, actions, chat.id, attach, startAttach, tabId);\n  }\n});\n\naddActionHandler('openTelegramLink', async (global, actions, payload): Promise<void> => {\n  const {\n    url,\n    shouldIgnoreCache,\n    linkContext,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const {\n    openChatByPhoneNumber,\n    checkChatInvite,\n    openStickerSet,\n    openChatWithDraft,\n    joinVoiceChatByLink,\n    openInvoice,\n    checkChatlistInvite,\n    openChatByUsername: openChatByUsernameAction,\n    openStoryViewerByUsername,\n    checkGiftCode,\n  } = actions;\n\n  if (isDeepLink(url)) {\n    const isProcessed = processDeepLink(url, linkContext);\n    if (isProcessed || url.match(RE_TG_LINK)) {\n      return;\n    }\n  }\n\n  const uri = new URL(url.toLowerCase().startsWith('http') ? url : `https://${url}`);\n  if (TME_WEB_DOMAINS.has(uri.hostname) && uri.pathname === '/') {\n    window.open(uri.toString(), '_blank', 'noopener');\n    return;\n  }\n\n  const hostname = TME_WEB_DOMAINS.has(uri.hostname) ? 't.me' : uri.hostname;\n  const hostParts = hostname.split('.');\n  if (hostParts.length > 3) return;\n\n  const adaptedPathname = uri.pathname.replace(/^\\/?s\\//, '');\n  const pathname = hostParts.length === 3 ? `${hostParts[0]}/${adaptedPathname}` : adaptedPathname;\n  const [part1, part2, part3] = pathname.split('/').filter(Boolean).map((part) => decodeURI(part));\n  const params = Object.fromEntries(uri.searchParams);\n\n  let hash: string | undefined;\n  if (part1 === 'joinchat') {\n    hash = part2;\n  }\n\n  const storyId = part2 === 's' && (Number(part3) || undefined);\n\n  if (part1.match(/^\\+([0-9]+)(\\?|$)/)) {\n    openChatByPhoneNumber({\n      phoneNumber: part1.substr(1, part1.length - 1),\n      startAttach: params.startattach,\n      attach: params.attach,\n      text: params.text,\n      tabId,\n    });\n    return;\n  }\n\n  if (storyId) {\n    openStoryViewerByUsername({\n      username: part1,\n      storyId,\n      tabId,\n    });\n\n    return;\n  }\n\n  if (part1.startsWith(' ') || part1.startsWith('+')) {\n    hash = part1.substr(1, part1.length - 1);\n  }\n\n  if (hash) {\n    checkChatInvite({ hash, tabId });\n    return;\n  }\n\n  if (part1 === 'addstickers' || part1 === 'addemoji') {\n    openStickerSet({\n      stickerSetInfo: {\n        shortName: part2,\n      },\n      shouldIgnoreCache,\n      tabId,\n    });\n    return;\n  }\n\n  if (part1 === 'share') {\n    const text = formatShareText(params.url, params.text);\n    openChatWithDraft({ text, tabId });\n    return;\n  }\n\n  if (part1 === 'addlist') {\n    const slug = part2;\n    checkChatlistInvite({ slug, tabId });\n    return;\n  }\n\n  if (part1 === 'giftcode') {\n    const slug = part2;\n    checkGiftCode({ slug, tabId });\n    return;\n  }\n\n  const chatOrChannelPostId = part2 || undefined;\n  const messageId = part3 ? Number(part3) : undefined;\n  const commentId = params.comment ? Number(params.comment) : undefined;\n\n  const isWebApp = await checkWebAppExists(global, part1, part2);\n\n  const shouldTryOpenChat = (part1 && !part2) || Number.isInteger(Number(part2)) || isWebApp;\n\n  if (params.hasOwnProperty('voicechat') || params.hasOwnProperty('livestream')) {\n    joinVoiceChatByLink({\n      username: part1,\n      inviteHash: params.voicechat || params.livestream,\n      tabId,\n    });\n  } else if (part1.startsWith('$')) {\n    openInvoice({\n      type: 'slug',\n      slug: part1.substring(1),\n      tabId,\n    });\n  } else if (part1 === 'invoice') {\n    openInvoice({\n      type: 'slug',\n      slug: part2,\n      tabId,\n    });\n  } else if (shouldTryOpenChat) {\n    openChatByUsernameAction({\n      username: part1,\n      messageId: messageId || Number(chatOrChannelPostId),\n      threadId: messageId ? Number(chatOrChannelPostId) : undefined,\n      commentId,\n      startParam: params.start,\n      startAttach: params.startattach,\n      attach: params.attach,\n      startApp: params.startapp,\n      mode: params.mode,\n      originalParts: [part1, part2, part3],\n      tabId,\n    });\n  } else {\n    actions.openUrl({\n      url, shouldSkipModal: true, tabId, ignoreDeepLinks: true,\n    });\n  }\n});\n\naddActionHandler('processBoostParameters', async (global, actions, payload): Promise<void> => {\n  const { usernameOrId, isPrivate, tabId = getCurrentTabId() } = payload;\n\n  let chat: ApiChat | undefined;\n\n  if (isPrivate) {\n    chat = selectChat(global, usernameOrId);\n    if (!chat) {\n      actions.showNotification({ message: { key: 'PrivateChannelInaccessible' }, tabId });\n      return;\n    }\n  } else {\n    chat = await fetchChatByUsername(global, usernameOrId);\n    if (!chat) {\n      actions.showNotification({ message: { key: 'NoUsernameFound' }, tabId });\n      return;\n    }\n  }\n\n  if (!isChatChannel(chat) && !isChatSuperGroup(chat)) {\n    actions.openChat({ id: chat.id, tabId });\n    return;\n  }\n\n  actions.openBoostModal({\n    chatId: chat.id,\n    tabId,\n  });\n});\n\naddActionHandler('acceptChatInvite', async (global, actions, payload): Promise<void> => {\n  const { hash, tabId = getCurrentTabId() } = payload;\n  const result = await callApi('importChatInvite', { hash });\n  if (!result) {\n    return;\n  }\n\n  actions.openChat({ id: result.id, tabId });\n});\n\naddActionHandler('openChatByUsername', async (global, actions, payload): Promise<void> => {\n  const {\n    username, messageId, commentId, startParam, startAttach, attach, threadId, originalParts,\n    startApp, shouldStartMainApp, mode, isDirect,\n    text, onChatChanged, choose, ref, timestamp, linkContext,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const chat = selectCurrentChat(global, tabId);\n  const webAppName = originalParts?.[1];\n  const isWebApp = webAppName && !Number(webAppName) && !originalParts?.[2];\n\n  if (!commentId) {\n    if (startAttach === undefined && messageId && !startParam && !ref\n      && chat?.usernames?.some((c) => c.username === username)) {\n      actions.focusMessage({\n        chatId: chat.id, threadId, messageId, timestamp, tabId,\n      });\n      return;\n    }\n\n    if (startAttach !== undefined && choose) {\n      actions.processAttachBotParameters({\n        username,\n        filter: choose,\n        startParam: startAttach || startApp,\n        tabId,\n      });\n      return;\n    }\n\n    if ((startApp !== undefined && !webAppName) || shouldStartMainApp) {\n      const theme = extractCurrentThemeParams();\n      const chatByUsername = await fetchChatByUsername(global, username);\n      global = getGlobal();\n      const user = chatByUsername && selectUser(global, chatByUsername.id);\n      if (!chatByUsername || !user?.hasMainMiniApp) return;\n      actions.requestMainWebView({\n        botId: chatByUsername.id,\n        peerId: chat?.id || chatByUsername.id,\n        theme,\n        startParam: startApp,\n        mode,\n        tabId,\n      });\n      return;\n    }\n    if (!isWebApp) {\n      await openChatByUsername(\n        global, actions, {\n          username,\n          threadId,\n          channelPostId: messageId,\n          startParam,\n          ref,\n          startAttach,\n          attach,\n          text,\n          timestamp,\n          linkContext,\n          isDirect,\n        }, tabId,\n      );\n      if (onChatChanged) {\n        // @ts-ignore\n        actions[onChatChanged.action](onChatChanged.payload);\n      }\n      return;\n    }\n  }\n\n  const usernameChat = selectChatByUsername(global, username);\n  if (commentId && messageId && usernameChat) {\n    actions.openThread({\n      isComments: true,\n      originChannelId: usernameChat.id,\n      originMessageId: messageId,\n      tabId,\n      focusMessageId: commentId,\n    });\n    if (timestamp) {\n      actions.openMediaFromTimestamp({\n        chatId: usernameChat.id,\n        messageId: commentId,\n        timestamp,\n        tabId,\n      });\n    }\n    return;\n  }\n\n  if (!isWebApp) actions.openChat({ id: TMP_CHAT_ID, tabId });\n\n  const chatByUsername = await fetchChatByUsername(global, username);\n\n  if (!chatByUsername) return;\n\n  if (isWebApp && chatByUsername) {\n    const theme = extractCurrentThemeParams();\n\n    actions.requestAppWebView({\n      appName: webAppName,\n      botId: chatByUsername.id,\n      tabId,\n      startApp,\n      mode,\n      theme,\n    });\n    return;\n  }\n\n  if (!messageId) return;\n\n  actions.openThread({\n    isComments: true,\n    originChannelId: chatByUsername.id,\n    originMessageId: messageId,\n    tabId,\n    focusMessageId: commentId,\n  });\n\n  if (timestamp) {\n    actions.openMediaFromTimestamp({\n      chatId: chatByUsername.id,\n      messageId: commentId || messageId,\n      timestamp,\n      tabId,\n    });\n  }\n\n  if (onChatChanged) {\n    // @ts-ignore\n    actions[onChatChanged.action](onChatChanged.payload);\n  }\n});\n\naddActionHandler('openPrivateChannel', (global, actions, payload): ActionReturnType => {\n  const {\n    id, commentId, messageId, threadId, timestamp, linkContext, tabId = getCurrentTabId(),\n  } = payload;\n  const chat = selectChat(global, id);\n  if (!chat) {\n    actions.showNotification({\n      message: {\n        key: 'PrivateChannelInaccessible',\n      },\n      tabId,\n    });\n    return;\n  }\n\n  if (!commentId && !messageId && !threadId) {\n    actions.openChat({ id, tabId });\n    return;\n  }\n\n  if (timestamp) {\n    actions.openMediaFromTimestamp({\n      chatId: id,\n      messageId: commentId || messageId!,\n      timestamp,\n      tabId,\n    });\n  }\n\n  if (commentId && messageId) {\n    actions.openThread({\n      isComments: true,\n      originChannelId: id,\n      originMessageId: messageId,\n      tabId,\n      focusMessageId: commentId,\n    });\n    return;\n  }\n\n  openChatWithParams(global, actions, chat, {\n    messageId,\n    threadId,\n    timestamp,\n    linkContext,\n  }, tabId);\n});\n\naddActionHandler('togglePreHistoryHidden', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, isEnabled,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const chat = await ensureIsSuperGroup(global, actions, chatId, tabId);\n  if (!chat) {\n    return;\n  }\n\n  global = getGlobal();\n  global = updateChatFullInfo(global, chat.id, { isPreHistoryHidden: isEnabled });\n  setGlobal(global);\n\n  void callApi('togglePreHistoryHidden', { chat, isEnabled });\n});\n\naddActionHandler('updateChatDefaultBannedRights', (global, actions, payload): ActionReturnType => {\n  const { chatId, bannedRights } = payload;\n  const chat = selectChat(global, chatId);\n\n  if (!chat) {\n    return;\n  }\n\n  void callApi('updateChatDefaultBannedRights', { chat, bannedRights });\n});\n\naddActionHandler('updateChatMemberBannedRights', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, userId, bannedRights,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const user = selectUser(global, userId);\n\n  if (!user) {\n    return;\n  }\n\n  const chat = await ensureIsSuperGroup(global, actions, chatId, tabId);\n\n  if (!chat) return;\n\n  const result = await callApi('updateChatMemberBannedRights', { chat, user, bannedRights });\n\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n\n  const updatedFullInfo = selectChatFullInfo(global, chat.id);\n  if (!updatedFullInfo) {\n    return;\n  }\n\n  const { members, kickedMembers } = updatedFullInfo;\n\n  const isBanned = Boolean(bannedRights.viewMessages);\n  const isUnblocked = !Object.keys(bannedRights).length;\n\n  global = updateChatFullInfo(global, chat.id, {\n    ...(members && isBanned && {\n      members: members.filter((m) => m.userId !== userId),\n    }),\n    ...(members && !isBanned && {\n      members: members.map((m) => (\n        m.userId === userId\n          ? { ...m, bannedRights }\n          : m\n      )),\n    }),\n    ...(isUnblocked && kickedMembers && {\n      kickedMembers: kickedMembers.filter((m) => m.userId !== userId),\n    }),\n  });\n  if (isBanned) {\n    global = updateChat(global, chat.id, { membersCount: Math.max(0, (chat.membersCount || 0) - 1) });\n  }\n\n  setGlobal(global);\n});\n\naddActionHandler('updateChatAdmin', async (global, actions, payload): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const {\n    chatId, userId, adminRights, customTitle,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const user = selectUser(global, userId);\n  if (!user) {\n    return;\n  }\n\n  const chat = await ensureIsSuperGroup(global, actions, chatId, tabId);\n\n  if (!chat) return;\n\n  await callApi('updateChatAdmin', {\n    chat, user, adminRights, customTitle,\n  });\n\n  const chatAfterUpdate = await callApi('fetchFullChat', chat);\n  if (!chatAfterUpdate?.fullInfo) {\n    return;\n  }\n\n  const { adminMembersById } = chatAfterUpdate.fullInfo;\n  const isDismissed = !Object.keys(adminRights).length;\n  let newAdminMembersById: Record<string, ApiChatMember> | undefined;\n  if (adminMembersById) {\n    if (isDismissed) {\n      const { [userId]: remove, ...rest } = adminMembersById;\n      newAdminMembersById = rest;\n    } else {\n      newAdminMembersById = {\n        ...adminMembersById,\n        [userId]: {\n          ...adminMembersById[userId],\n          adminRights,\n          customTitle,\n        },\n      };\n    }\n  }\n\n  if (newAdminMembersById) {\n    global = getGlobal();\n    global = updateChatFullInfo(global, chat.id, { adminMembersById: newAdminMembersById });\n    setGlobal(global);\n  }\n});\n\naddActionHandler('updateChat', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, title, about, photo, tabId = getCurrentTabId(),\n  } = payload;\n\n  const chat = selectChat(global, chatId);\n  const fullInfo = selectChatFullInfo(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  global = getGlobal();\n  global = updateManagementProgress(global, ManagementProgress.InProgress, tabId);\n  setGlobal(global);\n\n  await Promise.all([\n    chat.title !== title\n      ? callApi('updateChatTitle', chat, title)\n      : undefined,\n    fullInfo?.about !== about\n      ? callApi('updateChatAbout', chat, about)\n      : undefined,\n    photo\n      ? callApi('editChatPhoto', { chatId, accessHash: chat.accessHash, photo })\n      : undefined,\n  ]);\n\n  global = getGlobal();\n  global = updateManagementProgress(global, ManagementProgress.Complete, tabId);\n  setGlobal(global);\n\n  if (photo) {\n    actions.loadFullChat({ chatId, withPhotos: true });\n  }\n});\n\naddActionHandler('updateChatPhoto', async (global, actions, payload): Promise<void> => {\n  const { photo, chatId } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  await callApi('editChatPhoto', {\n    chatId,\n    accessHash: chat.accessHash,\n    photo,\n  });\n  actions.loadFullChat({ chatId, withPhotos: true });\n});\n\naddActionHandler('deleteChatPhoto', async (global, actions, payload): Promise<void> => {\n  const { photo, chatId } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  let isDeleted;\n  if (photo.id === chat.avatarPhotoId) {\n    isDeleted = await callApi('editChatPhoto', {\n      chatId,\n      accessHash: chat.accessHash,\n    });\n  } else {\n    isDeleted = await callApi('deleteProfilePhotos', [photo]);\n  }\n  if (!isDeleted) return;\n\n  global = getGlobal();\n  global = deletePeerPhoto(global, chatId, photo.id);\n  setGlobal(global);\n\n  actions.loadFullChat({ chatId, withPhotos: true });\n});\n\naddActionHandler('toggleSignatures', (global, actions, payload): ActionReturnType => {\n  const { chatId, areProfilesEnabled, areSignaturesEnabled } = payload;\n  const chat = selectChat(global, chatId);\n\n  if (!chat) {\n    return;\n  }\n\n  void callApi('toggleSignatures', { chat, areProfilesEnabled, areSignaturesEnabled });\n});\n\naddActionHandler('loadGroupsForDiscussion', async (global): Promise<void> => {\n  const groups = await callApi('fetchGroupsForDiscussion');\n  if (!groups) {\n    return;\n  }\n\n  const addedById = groups.reduce((result, group) => {\n    if (group && !group.isForum) {\n      result[group.id] = group;\n    }\n\n    return result;\n  }, {} as Record<string, ApiChat>);\n\n  global = getGlobal();\n  global = {\n    ...global,\n    chats: {\n      ...global.chats,\n      forDiscussionIds: Object.keys(addedById),\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('linkDiscussionGroup', async (global, actions, payload): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n  const { channelId, chatId, tabId = getCurrentTabId() } = payload || {};\n\n  const channel = selectChat(global, channelId);\n  if (!channel) {\n    return;\n  }\n\n  const chat = await ensureIsSuperGroup(global, actions, chatId, tabId);\n\n  if (!chat) return;\n\n  let fullInfo = selectChatFullInfo(global, chat.id);\n  if (!fullInfo) {\n    const fullChat = await callApi('fetchFullChat', chat);\n    if (!fullChat) {\n      return;\n    }\n\n    fullInfo = fullChat.fullInfo;\n  }\n\n  if (fullInfo.isPreHistoryHidden) {\n    global = getGlobal();\n    global = updateChatFullInfo(global, chat.id, { isPreHistoryHidden: false });\n    setGlobal(global);\n\n    await callApi('togglePreHistoryHidden', { chat, isEnabled: false });\n  }\n\n  void callApi('setDiscussionGroup', { channel, chat });\n});\n\naddActionHandler('unlinkDiscussionGroup', async (global, actions, payload): Promise<void> => {\n  const { channelId } = payload;\n\n  const channel = selectChat(global, channelId);\n  if (!channel) {\n    return;\n  }\n\n  const fullInfo = selectChatFullInfo(global, channelId);\n  let chat: ApiChat | undefined;\n  if (fullInfo?.linkedChatId) {\n    chat = selectChat(global, fullInfo.linkedChatId);\n  }\n\n  await callApi('setDiscussionGroup', { channel });\n  if (chat) {\n    global = getGlobal();\n    loadFullChat(global, actions, chat);\n  }\n});\n\naddActionHandler('setActiveChatFolder', (global, actions, payload): ActionReturnType => {\n  const { activeChatFolder, tabId = getCurrentTabId() } = payload;\n  const maxFolders = selectCurrentLimit(global, 'dialogFilters');\n\n  const isBlocked = activeChatFolder + 1 > maxFolders;\n\n  if (isBlocked) {\n    actions.openLimitReachedModal({\n      limit: 'dialogFilters',\n      tabId,\n    });\n    return undefined;\n  }\n\n  return updateTabState(global, {\n    activeChatFolder,\n  }, tabId);\n});\n\naddActionHandler('resetOpenChatWithDraft', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  return updateTabState(global, {\n    requestedDraft: undefined,\n  }, tabId);\n});\n\naddActionHandler('loadMoreMembers', async (global, actions, payload): Promise<void> => {\n  const { chatId } = payload || {};\n\n  if (selectIsCurrentUserFrozen(global)) return;\n  const chat = selectChat(global, chatId);\n  if (!chat || isChatBasicGroup(chat) || isChatMonoforum(chat)) {\n    return;\n  }\n\n  const offset = selectChatFullInfo(global, chat.id)?.members?.length;\n  if (offset !== undefined && chat.membersCount !== undefined && offset >= chat.membersCount) return;\n\n  const result = await callApi('fetchMembers', { chat, offset });\n  if (!result) {\n    return;\n  }\n\n  const { members, userStatusesById } = result;\n  if (!members || !members.length) {\n    return;\n  }\n\n  global = getGlobal();\n  global = addUserStatuses(global, userStatusesById);\n  global = addChatMembers(global, chat, members);\n  setGlobal(global);\n});\n\naddActionHandler('addChatMembers', async (global, actions, payload): Promise<void> => {\n  const { chatId, memberIds, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, chatId);\n  const users = memberIds.map((userId) => selectUser(global, userId)).filter(Boolean);\n\n  if (!chat || !users.length) {\n    return;\n  }\n\n  actions.setNewChatMembersDialogState({ newChatMembersProgress: NewChatMembersProgress.Loading, tabId });\n  const missingUsers = await callApi('addChatMembers', chat, users);\n  if (missingUsers) {\n    global = getGlobal();\n    global = updateMissingInvitedUsers(global, chatId, missingUsers, tabId);\n    setGlobal(global);\n  }\n  actions.setNewChatMembersDialogState({ newChatMembersProgress: NewChatMembersProgress.Closed, tabId });\n  global = getGlobal();\n  loadFullChat(global, actions, chat);\n});\n\naddActionHandler('deleteChatMember', async (global, actions, payload): Promise<void> => {\n  const { chatId, userId, tabId = getCurrentTabId() } = payload;\n  const chat = selectChat(global, chatId);\n  const user = selectUser(global, userId);\n\n  if (!chat || !user) {\n    return;\n  }\n\n  if (isChatSuperGroup(chat) || isChatChannel(chat)) {\n    actions.updateChatMemberBannedRights({\n      chatId,\n      userId,\n      bannedRights: {\n        viewMessages: true,\n        sendMessages: true,\n        sendMedia: true,\n        sendStickers: true,\n        sendGifs: true,\n        sendGames: true,\n        sendInline: true,\n        embedLinks: true,\n        sendPolls: true,\n        changeInfo: true,\n        inviteUsers: true,\n        pinMessages: true,\n        manageTopics: true,\n        sendPhotos: true,\n        sendVideos: true,\n        sendRoundvideos: true,\n        sendAudios: true,\n        sendVoices: true,\n        sendDocs: true,\n        sendPlain: true,\n      },\n      tabId,\n    });\n    return;\n  }\n\n  await callApi('deleteChatMember', chat, user);\n  global = getGlobal();\n  loadFullChat(global, actions, chat);\n});\n\naddActionHandler('toggleIsProtected', (global, actions, payload): ActionReturnType => {\n  const { chatId, isProtected } = payload;\n  const chat = selectChat(global, chatId);\n\n  if (!chat) {\n    return;\n  }\n\n  void callApi('toggleIsProtected', { chat, isProtected });\n});\n\naddActionHandler('setChatEnabledReactions', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, enabledReactions, reactionsLimit,\n  } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  await callApi('setChatEnabledReactions', {\n    chat,\n    enabledReactions,\n    reactionsLimit,\n  });\n\n  global = getGlobal();\n  void loadFullChat(global, actions, chat);\n});\n\naddActionHandler('fetchChat', (global, actions, payload): ActionReturnType => {\n  const { chatId } = payload;\n  const chat = selectChat(global, chatId);\n\n  if (chat) {\n    return;\n  }\n\n  if (selectIsChatWithSelf(global, chatId)) {\n    void callApi('fetchChat', { type: 'self' });\n  } else {\n    const user = selectUser(global, chatId);\n    if (user) {\n      void callApi('fetchChat', { type: 'user', user });\n    }\n  }\n});\n\naddActionHandler('toggleJoinToSend', async (global, actions, payload): Promise<void> => {\n  const { chatId, isEnabled } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n  if (!isChatSuperGroup(chat) && !isChatChannel(chat)) return;\n\n  await callApi('toggleJoinToSend', chat, isEnabled);\n});\n\naddActionHandler('toggleJoinRequest', async (global, actions, payload): Promise<void> => {\n  const { chatId, isEnabled } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n  if (!isChatSuperGroup(chat) && !isChatChannel(chat)) return;\n\n  await callApi('toggleJoinRequest', chat, isEnabled);\n});\n\naddActionHandler('openForumPanel', (global, actions, payload): ActionReturnType => {\n  const { chatId, tabId = getCurrentTabId() } = payload;\n  actions.toggleStoryRibbon({ isShown: false, tabId });\n  actions.toggleStoryRibbon({ isShown: false, isArchived: true, tabId });\n  return updateTabState(global, {\n    forumPanelChatId: chatId,\n  }, tabId);\n});\n\naddActionHandler('closeForumPanel', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  return updateTabState(global, {\n    forumPanelChatId: undefined,\n  }, tabId);\n});\n\naddActionHandler('processAttachBotParameters', async (global, actions, payload): Promise<void> => {\n  const {\n    username, filter, startParam, tabId = getCurrentTabId(),\n  } = payload;\n  const bot = await getAttachBotOrNotify(global, actions, username, tabId);\n  if (!bot) return;\n\n  const isForChat = Boolean(filter);\n\n  if (!isForChat) {\n    actions.callAttachBot({\n      isFromSideMenu: true,\n      bot,\n      startParam,\n      tabId,\n    });\n    return;\n  }\n\n  global = getGlobal();\n  const { attachMenu: { bots } } = global;\n  if (!bots[bot.id]) {\n    global = updateTabState(global, {\n      requestedAttachBotInstall: {\n        bot,\n        onConfirm: {\n          action: 'requestAttachBotInChat',\n          payload: {\n            bot,\n            filter,\n            startParam,\n          },\n        },\n      },\n    }, tabId);\n    setGlobal(global);\n    return;\n  }\n  actions.requestAttachBotInChat({\n    bot,\n    filter,\n    startParam,\n    tabId,\n  });\n});\n\naddActionHandler('loadTopics', async (global, actions, payload): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n  const { chatId, force } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  const topicsInfo = selectTopicsInfo(global, chatId);\n\n  if (!force && topicsInfo?.listedTopicIds && topicsInfo.listedTopicIds.length === topicsInfo.totalCount) {\n    return;\n  }\n\n  const offsetTopic = !force ? topicsInfo?.listedTopicIds?.reduce((acc, el) => {\n    const topic = selectTopic(global, chatId, el);\n    const accTopic = selectTopic(global, chatId, acc);\n    if (!topic) return acc;\n    if (!accTopic || topic.lastMessageId < accTopic.lastMessageId) {\n      return el;\n    }\n    return acc;\n  }) : undefined;\n\n  const { id: offsetTopicId, date: offsetDate, lastMessageId: offsetId } = (offsetTopic\n    && selectTopic(global, chatId, offsetTopic)) || {};\n  const result = await callApi('fetchTopics', {\n    chat, offsetTopicId, offsetId, offsetDate, limit: offsetTopicId ? TOPICS_SLICE : TOPICS_SLICE_SECOND_LOAD,\n  });\n\n  if (!result) return;\n\n  global = getGlobal();\n  global = addMessages(global, result.messages);\n  global = updateTopics(global, chatId, result.count, result.topics);\n  global = updateListedTopicIds(global, chatId, result.topics.map((topic) => topic.id));\n  Object.entries(result.draftsById || {}).forEach(([threadId, draft]) => {\n    global = replaceThreadParam(global, chatId, Number(threadId), 'draft', draft);\n  });\n  Object.entries(result.readInboxMessageIdByTopicId || {}).forEach(([topicId, messageId]) => {\n    global = updateThreadInfo(global, chatId, Number(topicId), { lastReadInboxMessageId: messageId });\n  });\n\n  setGlobal(global);\n});\n\naddActionHandler('loadTopicById', async (global, actions, payload): Promise<void> => {\n  const { chatId, topicId } = payload;\n\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  const result = await callApi('fetchTopicById', { chat, topicId });\n\n  if (!result) {\n    if ('tabId' in payload && payload.shouldCloseChatOnError) {\n      const { tabId = getCurrentTabId() } = payload;\n      actions.openChat({ id: undefined, tabId });\n    }\n    return;\n  }\n\n  global = getGlobal();\n  global = addMessages(global, result.messages);\n  global = updateTopic(global, chatId, topicId, result.topic);\n\n  setGlobal(global);\n});\n\naddActionHandler('toggleForum', async (global, actions, payload): Promise<void> => {\n  const { chatId, isEnabled, tabId = getCurrentTabId() } = payload;\n\n  const chat = await ensureIsSuperGroup(global, actions, chatId, tabId);\n  if (!chat) {\n    return;\n  }\n\n  let result: true | undefined;\n  try {\n    result = await callApi('toggleForum', { chat, isEnabled });\n  } catch (error) {\n    if ((error as ApiError).message === 'FLOOD') {\n      actions.showNotification({ message: langProvider.oldTranslate('FloodWait'), tabId });\n    } else {\n      actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n    }\n  }\n\n  if (result) {\n    global = getGlobal();\n    global = updateChat(global, chat.id, { isForum: isEnabled });\n    setGlobal(global);\n\n    if (!isEnabled) {\n      actions.closeForumPanel({ tabId });\n    } else {\n      actions.openForumPanel({ chatId: chat.id, tabId });\n    }\n  }\n});\n\naddActionHandler('toggleParticipantsHidden', async (global, actions, payload): Promise<void> => {\n  const { chatId, isEnabled } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const prevIsEnabled = selectChatFullInfo(global, chat.id)?.areParticipantsHidden;\n  global = updateChatFullInfo(global, chatId, { areParticipantsHidden: isEnabled });\n  setGlobal(global);\n\n  const result = await callApi('toggleParticipantsHidden', { chat, isEnabled });\n\n  if (!result && prevIsEnabled !== undefined) {\n    global = getGlobal();\n    global = updateChatFullInfo(global, chatId, { areParticipantsHidden: prevIsEnabled });\n    setGlobal(global);\n  }\n});\n\naddActionHandler('createTopic', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, title, iconColor, iconEmojiId,\n    tabId = getCurrentTabId(),\n  } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  if (selectTabState(global, tabId).createTopicPanel) {\n    global = updateTabState(global, {\n      createTopicPanel: {\n        chatId,\n        isLoading: true,\n      },\n    }, tabId);\n    setGlobal(global);\n  }\n\n  const topicId = await callApi('createTopic', {\n    chat, title, iconColor, iconEmojiId,\n  });\n  if (topicId) {\n    actions.openThread({\n      chatId, threadId: topicId, shouldReplaceHistory: true, tabId,\n    });\n  }\n  actions.closeCreateTopicPanel({ tabId });\n});\n\naddActionHandler('deleteTopic', async (global, actions, payload): Promise<void> => {\n  const { chatId, topicId } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  await callApi('deleteTopic', { chat, topicId });\n\n  global = getGlobal();\n  global = deleteTopic(global, chatId, topicId);\n  setGlobal(global);\n});\n\naddActionHandler('editTopic', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, topicId, tabId = getCurrentTabId(), ...rest\n  } = payload;\n  const chat = selectChat(global, chatId);\n  const topic = selectTopic(global, chatId, topicId);\n  if (!chat || !topic) return;\n\n  if (selectTabState(global, tabId).editTopicPanel) {\n    global = updateTabState(global, {\n      editTopicPanel: {\n        chatId,\n        topicId,\n        isLoading: true,\n      },\n    }, tabId);\n    setGlobal(global);\n  }\n\n  const result = await callApi('editTopic', { chat, topicId, ...rest });\n  if (!result) return;\n\n  global = getGlobal();\n  global = updateTopic(global, chatId, topicId, rest);\n  setGlobal(global);\n\n  actions.closeEditTopicPanel({ tabId });\n});\n\naddActionHandler('toggleTopicPinned', (global, actions, payload): ActionReturnType => {\n  const {\n    chatId, topicId, isPinned, tabId = getCurrentTabId(),\n  } = payload;\n\n  const { topicsPinnedLimit } = global.appConfig;\n  const chat = selectChat(global, chatId);\n  const topics = selectTopics(global, chatId);\n  if (!chat || !topics || !topicsPinnedLimit) return;\n\n  if (isPinned && Object.values(topics).filter((topic) => topic.isPinned).length >= topicsPinnedLimit) {\n    actions.showNotification({\n      message: langProvider.oldTranslate('LimitReachedPinnedTopics', topicsPinnedLimit, 'i'),\n      tabId,\n    });\n    return;\n  }\n\n  void callApi('togglePinnedTopic', { chat, topicId, isPinned });\n});\n\naddActionHandler('checkChatlistInvite', async (global, actions, payload): Promise<void> => {\n  const { slug, tabId = getCurrentTabId() } = payload;\n\n  const result = await callApi('checkChatlistInvite', { slug });\n  if (!result) {\n    actions.showNotification({\n      message: langProvider.oldTranslate('lng_group_invite_bad_link'),\n      tabId,\n    });\n    return;\n  }\n\n  global = getGlobal();\n\n  global = updateTabState(global, {\n    chatlistModal: {\n      invite: result.invite,\n    },\n  }, tabId);\n\n  setGlobal(global);\n});\n\naddActionHandler('joinChatlistInvite', async (global, actions, payload): Promise<void> => {\n  const { invite, peerIds, tabId = getCurrentTabId() } = payload;\n\n  const peers = peerIds.map((peerId) => selectChat(global, peerId)).filter(Boolean);\n  const currentNotJoinedCount = peers.filter((peer) => peer.isNotJoined).length;\n\n  const existingFolder = 'folderId' in invite ? selectChatFolder(global, invite.folderId) : undefined;\n  const folderTitle = ('title' in invite ? invite.title : existingFolder?.title)!;\n\n  try {\n    const result = await callApi('joinChatlistInvite', { slug: invite.slug, peers });\n    if (!result) return;\n\n    if (existingFolder) {\n      actions.showNotification({\n        title: {\n          key: 'FolderLinkNotificationUpdatedTitle',\n          variables: {\n            title: folderTitle.text,\n          },\n        },\n        message: {\n          key: 'FolderLinkNotificationUpdatedSubtitle',\n          variables: {\n            count: currentNotJoinedCount,\n          },\n          options: {\n            pluralValue: currentNotJoinedCount,\n          },\n        },\n        tabId,\n      });\n\n      return;\n    }\n\n    actions.showNotification({\n      title: {\n        key: 'FolderLinkNotificationAddedTitle',\n        variables: {\n          title: folderTitle.text,\n        },\n      },\n      message: {\n        key: 'FolderLinkNotificationAddedSubtitle',\n        variables: {\n          count: currentNotJoinedCount,\n        },\n        options: {\n          pluralValue: currentNotJoinedCount,\n        },\n      },\n      tabId,\n    });\n  } catch (error) {\n    if ((error as ApiError).message === 'CHATLISTS_TOO_MUCH') {\n      actions.openLimitReachedModal({ limit: 'chatlistJoined', tabId });\n    } else {\n      actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n    }\n  }\n});\n\naddActionHandler('leaveChatlist', async (global, actions, payload): Promise<void> => {\n  const { folderId, peerIds, tabId = getCurrentTabId() } = payload;\n\n  const folder = selectChatFolder(global, folderId);\n\n  const peers = peerIds?.map((peerId) => selectChat(global, peerId)).filter(Boolean) || [];\n\n  const result = await callApi('leaveChatlist', { folderId, peers });\n\n  if (!result) return;\n  if (!folder) return;\n\n  actions.showNotification({\n    title: {\n      key: 'FolderLinkNotificationDeletedTitle',\n      variables: {\n        title: folder.title.text,\n      },\n    },\n    message: {\n      key: 'FolderLinkNotificationDeletedSubtitle',\n      variables: {\n        count: peers.length,\n      },\n      options: {\n        pluralValue: peers.length,\n      },\n    },\n    tabId,\n  });\n});\n\naddActionHandler('loadChatlistInvites', async (global, actions, payload): Promise<void> => {\n  const { folderId } = payload;\n\n  const result = await callApi('fetchChatlistInvites', { folderId });\n\n  if (!result) return;\n\n  global = getGlobal();\n\n  global = {\n    ...global,\n    chatFolders: {\n      ...global.chatFolders,\n      invites: {\n        ...global.chatFolders.invites,\n        [folderId]: result.invites,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('createChatlistInvite', async (global, actions, payload): Promise<void> => {\n  const { folderId, tabId = getCurrentTabId() } = payload;\n\n  const folder = selectChatFolder(global, folderId);\n  if (!folder) return;\n\n  global = updateTabState(global, {\n    shareFolderScreen: {\n      ...selectTabState(global, tabId).shareFolderScreen!,\n      isLoading: true,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  let result: { filter: ApiChatFolder; invite: ApiChatlistExportedInvite | undefined } | undefined;\n\n  try {\n    result = await callApi('createChalistInvite', {\n      folderId,\n      peers: folder.includedChatIds.concat(folder.pinnedChatIds || [])\n        .map((chatId) => selectChat(global, chatId) || selectUser(global, chatId)).filter(Boolean),\n    });\n  } catch (error) {\n    if (CHATLIST_LIMIT_ERROR_LIST.has((error as ApiError).message)) {\n      actions.openLimitReachedModal({ limit: 'chatlistInvites', tabId });\n      actions.openSettingsScreen({ screen: SettingsScreens.Folders, tabId });\n    } else {\n      actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n    }\n  }\n\n  if (!result || !result.invite) return;\n\n  const { shareFolderScreen } = selectTabState(global, tabId);\n\n  if (!shareFolderScreen) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    chatFolders: {\n      ...global.chatFolders,\n      byId: {\n        ...global.chatFolders.byId,\n        [folderId]: {\n          ...global.chatFolders.byId[folderId],\n          ...result.filter,\n        },\n      },\n      invites: {\n        ...global.chatFolders.invites,\n        [folderId]: [\n          ...(global.chatFolders.invites[folderId] || []),\n          result.invite,\n        ],\n      },\n    },\n  };\n  global = updateTabState(global, {\n    shareFolderScreen: {\n      ...shareFolderScreen,\n      url: result.invite.url,\n      isLoading: false,\n    },\n  }, tabId);\n  setGlobal(global);\n});\n\naddActionHandler('editChatlistInvite', async (global, actions, payload): Promise<void> => {\n  const {\n    folderId, peerIds, url, tabId = getCurrentTabId(),\n  } = payload;\n\n  const slug = url.split('/').pop();\n  if (!slug) return;\n\n  const peers = peerIds\n    .map((chatId) => selectChat(global, chatId) || selectUser(global, chatId)).filter(Boolean);\n\n  global = updateTabState(global, {\n    shareFolderScreen: {\n      ...selectTabState(global, tabId).shareFolderScreen!,\n      isLoading: true,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  try {\n    const result = await callApi('editChatlistInvite', { folderId, slug, peers });\n\n    if (!result) {\n      return;\n    }\n\n    global = getGlobal();\n    global = {\n      ...global,\n      chatFolders: {\n        ...global.chatFolders,\n        invites: {\n          ...global.chatFolders.invites,\n          [folderId]: global.chatFolders.invites[folderId]?.map((invite) => {\n            if (invite.url === url) {\n              return result;\n            }\n            return invite;\n          }),\n        },\n      },\n    };\n    setGlobal(global);\n  } catch (error) {\n    actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n  } finally {\n    global = getGlobal();\n\n    global = updateTabState(global, {\n      shareFolderScreen: {\n        ...selectTabState(global, tabId).shareFolderScreen!,\n        isLoading: false,\n      },\n    }, tabId);\n    setGlobal(global);\n  }\n});\n\naddActionHandler('deleteChatlistInvite', async (global, actions, payload): Promise<void> => {\n  const { folderId, url } = payload;\n\n  const slug = url.split('/').pop();\n\n  if (!slug) return;\n\n  const result = await callApi('deleteChatlistInvite', { folderId, slug });\n\n  if (!result) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    chatFolders: {\n      ...global.chatFolders,\n      invites: {\n        ...global.chatFolders.invites,\n        [folderId]: global.chatFolders.invites[folderId]?.filter((invite) => invite.url !== url),\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('openDeleteChatFolderModal', async (global, actions, payload): Promise<void> => {\n  const { folderId, isConfirmedForChatlist, tabId = getCurrentTabId() } = payload;\n  const folder = selectChatFolder(global, folderId);\n  if (!folder) return;\n\n  if (folder.isChatList && (!folder.hasMyInvites || isConfirmedForChatlist)) {\n    const currentIds = getOrderedIds(folderId);\n    const suggestions = await callApi('fetchLeaveChatlistSuggestions', { folderId });\n    global = getGlobal();\n    global = updateTabState(global, {\n      chatlistModal: {\n        removal: {\n          folderId,\n          suggestedPeerIds: unique([...(suggestions || []), ...(currentIds || [])]),\n        },\n      },\n    }, tabId);\n    setGlobal(global);\n    return;\n  }\n\n  global = updateTabState(global, {\n    deleteFolderDialogModal: folderId,\n  }, tabId);\n\n  setGlobal(global);\n});\n\naddActionHandler('updateChatDetectedLanguage', (global, actions, payload): ActionReturnType => {\n  const { chatId, detectedLanguage } = payload;\n\n  global = getGlobal();\n  global = updateChat(global, chatId, {\n    detectedLanguage,\n  }, undefined, true);\n\n  return global;\n});\n\naddActionHandler('togglePeerTranslations', async (global, actions, payload): Promise<void> => {\n  const { chatId, isEnabled } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  const result = await callApi('togglePeerTranslations', { chat, isEnabled });\n\n  if (result === undefined) return;\n\n  global = getGlobal();\n  global = updatePeerFullInfo(global, chatId, {\n    isTranslationDisabled: isEnabled ? undefined : true,\n  });\n  setGlobal(global);\n});\n\naddActionHandler('setViewForumAsMessages', (global, actions, payload): ActionReturnType => {\n  const { chatId, isEnabled } = payload;\n\n  const chat = selectChat(global, chatId);\n  if (!chat?.isForum || chat.isForumAsMessages === isEnabled) {\n    return;\n  }\n\n  global = updateChat(global, chatId, { isForumAsMessages: isEnabled || undefined });\n  setGlobal(global);\n\n  void callApi('setViewForumAsMessages', { chat, isEnabled });\n});\n\naddActionHandler('loadChannelRecommendations', async (global, actions, payload): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const { chatId } = payload;\n  const chat = chatId ? selectChat(global, chatId) : undefined;\n\n  if (chatId && !chat) {\n    return;\n  }\n\n  if (!chatId) {\n    const similarChannelIds = selectSimilarChannelIds(global, GLOBAL_SUGGESTED_CHANNELS_ID);\n    if (similarChannelIds) return; // Already cached\n  }\n\n  const result = await callApi('fetchChannelRecommendations', {\n    chat,\n  });\n\n  if (!result) {\n    return;\n  }\n\n  const { similarChannels, count } = result;\n\n  const chatsById = buildCollectionByKey(similarChannels, 'id');\n\n  global = getGlobal();\n  global = replaceSimilarChannels(global, chatId || GLOBAL_SUGGESTED_CHANNELS_ID, Object.keys(chatsById), count);\n  setGlobal(global);\n});\n\naddActionHandler('loadBotRecommendations', async (global, actions, payload): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const { userId } = payload;\n  const user = selectChat(global, userId);\n\n  if (!user) {\n    return;\n  }\n\n  const result = await callApi('fetchBotsRecommendations', {\n    user,\n  });\n\n  if (!result) {\n    return;\n  }\n\n  const { similarBots, count } = result;\n\n  const users = buildCollectionByKey(similarBots, 'id');\n\n  global = getGlobal();\n  global = addUsers(global, users);\n  global = addSimilarBots(global, userId, Object.keys(users), count);\n  setGlobal(global);\n});\n\naddActionHandler('toggleChannelRecommendations', (global, actions, payload): ActionReturnType => {\n  const { chatId } = payload;\n  const chat = selectChat(global, chatId);\n\n  if (!chat) {\n    return;\n  }\n\n  global = toggleSimilarChannels(global, chatId);\n  setGlobal(global);\n});\n\naddActionHandler('updatePaidMessagesPrice', async (global, actions, payload): Promise<void> => {\n  const { chatId, paidMessagesStars, tabId = getCurrentTabId() } = payload;\n  const chat = chatId ? selectChat(global, chatId) : undefined;\n  if (!chat) return;\n\n  global = updateManagementProgress(global, ManagementProgress.InProgress, tabId);\n  setGlobal(global);\n\n  const result = await callApi('updatePaidMessagesPrice', {\n    chat,\n    paidMessagesStars,\n  });\n\n  if (!result) return;\n\n  global = getGlobal();\n  global = updateManagementProgress(global, ManagementProgress.Complete, tabId);\n  global = updateChat(global, chatId, { paidMessagesStars });\n  setGlobal(global);\n});\n\naddActionHandler('toggleAutoTranslation', async (global, actions, payload): Promise<void> => {\n  const { chatId, isEnabled } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  const result = await callApi('toggleAutoTranslation', { chat, isEnabled });\n  if (!result) return;\n\n  global = getGlobal();\n  global = updateChat(global, chatId, { hasAutoTranslation: isEnabled || undefined });\n  setGlobal(global);\n});\n\naddActionHandler('setMainProfileTab', async (global, actions, payload): Promise<void> => {\n  const { chatId, tab } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  const peerFullInfo = selectPeerFullInfo(global, chatId);\n  const oldMainTab = peerFullInfo?.mainTab;\n  if (oldMainTab === tab) return;\n\n  global = updatePeerFullInfo(global, chatId, { mainTab: tab });\n  setGlobal(global);\n\n  let result;\n  if (chatId === global.currentUserId) {\n    result = await callApi('setAccountMainProfileTab', { tab });\n  } else {\n    result = await callApi('setChannelMainProfileTab', { chat, tab });\n  }\n\n  if (!result) {\n    global = getGlobal();\n    global = updatePeerFullInfo(global, chatId, { mainTab: oldMainTab });\n    setGlobal(global);\n  }\n});\n\naddActionHandler('resolveBusinessChatLink', async (global, actions, payload): Promise<void> => {\n  const { slug, tabId = getCurrentTabId() } = payload;\n  const result = await callApi('resolveBusinessChatLink', { slug });\n  if (!result) {\n    actions.showNotification({\n      message: langProvider.oldTranslate('BusinessLink.ErrorExpired'),\n      tabId,\n    });\n    return;\n  }\n\n  const { chatLink } = result;\n\n  actions.openChatWithDraft({\n    chatId: chatLink.chatId,\n    text: chatLink.text,\n    tabId,\n  });\n});\n\naddActionHandler('requestCollectibleInfo', async (global, actions, payload): Promise<void> => {\n  const {\n    type, collectible, peerId, tabId = getCurrentTabId(),\n  } = payload;\n\n  let inputCollectible;\n  if (type === 'phone') {\n    inputCollectible = { phone: collectible };\n  }\n  if (type === 'username') {\n    inputCollectible = { username: collectible };\n  }\n  if (!inputCollectible) return;\n\n  const result = await callApi('fetchCollectionInfo', inputCollectible);\n  if (!result) {\n    copyTextToClipboard(collectible);\n    return;\n  }\n\n  global = getGlobal();\n  global = updateTabState(global, {\n    collectibleInfoModal: {\n      ...result,\n      type,\n      collectible,\n      peerId,\n    },\n  }, tabId);\n  setGlobal(global);\n});\n\nasync function loadChats(\n  listType: ChatListType,\n  isFullDraftSync?: boolean,\n  shouldIgnorePagination?: boolean,\n) {\n  let global = getGlobal();\n  let lastLocalServiceMessageId = selectLastServiceNotification(global)?.id;\n\n  const params = !shouldIgnorePagination ? selectChatListLoadingParameters(global, listType) : {};\n  const offsetPeer = params.nextOffsetPeerId ? selectPeer(global, params.nextOffsetPeerId) : undefined;\n  const offsetDate = params.nextOffsetDate;\n  const offsetId = params.nextOffsetId;\n\n  const isFirstBatch = !shouldIgnorePagination && !offsetPeer && !offsetDate && !offsetId;\n  const shouldReplaceStaleState = listType === 'active' && isFirstBatch;\n  const isAccountFreeze = selectIsCurrentUserFrozen(global);\n\n  const result = listType === 'saved' ? await callApi('fetchSavedChats', {\n    limit: CHAT_LIST_LOAD_SLICE,\n    offsetDate,\n    offsetId,\n    offsetPeer,\n    withPinned: isFirstBatch && !isAccountFreeze,\n  }) : await callApi('fetchChats', {\n    limit: CHAT_LIST_LOAD_SLICE,\n    offsetDate,\n    offsetId,\n    offsetPeer,\n    archived: listType === 'archived',\n    withPinned: isFirstBatch && !isAccountFreeze,\n    lastLocalServiceMessageId,\n  });\n\n  if (!result) {\n    return;\n  }\n\n  const { chatIds } = result;\n\n  global = getGlobal();\n  lastLocalServiceMessageId = selectLastServiceNotification(global)?.id;\n\n  const newChats = buildCollectionByKey(result.chats, 'id');\n\n  global = updateUsers(global, buildCollectionByKey(result.users, 'id'));\n  global = updateChats(global, newChats);\n  if (isFirstBatch) {\n    global = replaceChatListIds(global, listType, chatIds);\n  } else {\n    global = addChatListIds(global, listType, chatIds);\n  }\n\n  if (shouldReplaceStaleState) {\n    global = replaceUserStatuses(global, result.userStatusesById);\n    global = replaceNotifyExceptions(global, result.notifyExceptionById);\n  } else {\n    global = addUserStatuses(global, result.userStatusesById);\n    global = addNotifyExceptions(global, result.notifyExceptionById);\n  }\n\n  global = updateChatListSecondaryInfo(global, listType, result);\n  global = replaceMessages(global, result.messages);\n  global = updateChatsLastMessageId(global, result.lastMessageByChatId, listType);\n\n  if (!shouldIgnorePagination) {\n    global = replaceChatListLoadingParameters(\n      global, listType, result.nextOffsetId, result.nextOffsetPeerId, result.nextOffsetDate,\n    );\n  }\n\n  if (listType === 'active' || listType === 'archived') {\n    const idsToUpdateDraft = isFullDraftSync ? result.chatIds : Object.keys(result.draftsById);\n    idsToUpdateDraft.forEach((chatId) => {\n      const draft = result.draftsById[chatId];\n      const thread = selectThread(global, chatId, MAIN_THREAD_ID);\n\n      if (!draft && !thread) return;\n\n      if (!selectDraft(global, chatId, MAIN_THREAD_ID)?.isLocal) {\n        global = replaceThreadParam(\n          global, chatId, MAIN_THREAD_ID, 'draft', draft,\n        );\n      }\n    });\n  }\n\n  if ((chatIds.length === 0 || chatIds.length === result.totalChatCount) && !global.chats.isFullyLoaded[listType]) {\n    global = {\n      ...global,\n      chats: {\n        ...global.chats,\n        isFullyLoaded: {\n          ...global.chats.isFullyLoaded,\n          [listType]: true,\n        },\n      },\n    };\n  }\n\n  setGlobal(global);\n}\n\nexport async function loadFullChat<T extends GlobalState>(\n  global: T, actions: RequiredGlobalActions, chat: ApiChat,\n) {\n  if (selectIsCurrentUserFrozen(global)) return undefined;\n  const result = await callApi('fetchFullChat', chat);\n  if (!result) {\n    return undefined;\n  }\n\n  const {\n    chats, userStatusesById, fullInfo, groupCall, membersCount, isForumAsMessages,\n  } = result;\n\n  global = getGlobal();\n  global = updateChats(global, buildCollectionByKey(chats, 'id'));\n\n  if (userStatusesById) {\n    global = addUserStatuses(global, userStatusesById);\n  }\n\n  if (groupCall) {\n    const existingGroupCall = selectGroupCall(global, groupCall.id!);\n    global = updateGroupCall(\n      global,\n      groupCall.id!,\n      omit(groupCall, ['connectionState', 'isLoaded']),\n      undefined,\n      existingGroupCall ? undefined : groupCall.participantsCount,\n    );\n  }\n\n  if (membersCount !== undefined) {\n    global = updateChat(global, chat.id, { membersCount });\n  }\n  if (chat.isForum) {\n    global = updateChat(global, chat.id, { isForumAsMessages });\n  }\n  global = replaceChatFullInfo(global, chat.id, fullInfo);\n  setGlobal(global);\n\n  const stickerSet = fullInfo.stickerSet;\n  const localSet = stickerSet && selectStickerSet(global, stickerSet);\n  if (stickerSet && !localSet) {\n    actions.loadStickers({\n      stickerSetInfo: {\n        id: stickerSet.id,\n        accessHash: stickerSet.accessHash,\n      },\n    });\n  }\n\n  const emojiSet = fullInfo.emojiSet;\n  const localEmojiSet = emojiSet && selectStickerSet(global, emojiSet);\n  if (emojiSet && !localEmojiSet) {\n    actions.loadStickers({\n      stickerSetInfo: {\n        id: emojiSet.id,\n        accessHash: emojiSet.accessHash,\n      },\n    });\n  }\n\n  return result;\n}\n\nexport async function migrateChat<T extends GlobalState>(\n  global: T, actions: RequiredGlobalActions, chat: ApiChat,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): Promise<ApiChat | undefined> {\n  try {\n    const supergroup = await callApi('migrateChat', chat);\n\n    return supergroup;\n  } catch (error) {\n    if ((error as ApiError).message === 'CHANNELS_TOO_MUCH') {\n      actions.openLimitReachedModal({ limit: 'channels', tabId });\n    } else {\n      actions.showDialog({ data: { ...(error as ApiError), hasErrorKey: true }, tabId });\n    }\n\n    return undefined;\n  }\n}\n\nexport async function fetchChatByUsername<T extends GlobalState>(\n  global: T,\n  username: string,\n  referrer?: string,\n) {\n  global = getGlobal();\n  const localChat = !referrer ? selectChatByUsername(global, username) : undefined;\n  if (localChat && !localChat.isMin) {\n    return localChat;\n  }\n\n  const { chat, user } = await callApi('getChatByUsername', username, referrer) || {};\n  if (!chat) {\n    return undefined;\n  }\n\n  global = getGlobal();\n  global = updateChat(global, chat.id, chat);\n  if (user) {\n    global = updateUser(global, user.id, user);\n  }\n\n  setGlobal(global);\n\n  return chat;\n}\n\nexport async function checkWebAppExists<T extends GlobalState>(\n  global: T, botName: string, appName: string,\n) {\n  if (!botName || !appName) return false;\n  global = getGlobal();\n  const chatByUsername = await fetchChatByUsername(global, botName);\n  global = getGlobal();\n  const bot = chatByUsername && selectUser(global, chatByUsername.id);\n  const botApp = bot && await callApi('fetchBotApp', {\n    bot,\n    appName,\n  });\n  return Boolean(botApp);\n}\n\nexport async function fetchChatByPhoneNumber<T extends GlobalState>(global: T, phoneNumber: string) {\n  global = getGlobal();\n  const localUser = selectUserByPhoneNumber(global, phoneNumber);\n  if (localUser && !localUser.isMin) {\n    return selectChat(global, localUser.id);\n  }\n\n  const { chat, user } = await callApi('getChatByPhoneNumber', phoneNumber) || {};\n  if (!chat) {\n    return undefined;\n  }\n\n  global = getGlobal();\n  global = updateChat(global, chat.id, chat);\n\n  if (user) {\n    global = updateUser(global, user.id, user);\n  }\n  setGlobal(global);\n\n  return chat;\n}\n\nasync function getAttachBotOrNotify<T extends GlobalState>(\n  global: T, actions: RequiredGlobalActions, username: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const chat = await fetchChatByUsername(global, username);\n  if (!chat) return undefined;\n\n  global = getGlobal();\n  const user = selectUser(global, chat.id);\n  if (!user) return undefined;\n\n  const isBot = isUserBot(user);\n  if (!isBot) return undefined;\n  const result = await callApi('loadAttachBot', {\n    bot: user,\n  });\n\n  global = getGlobal();\n  if (!result) {\n    actions.showNotification({\n      message: langProvider.oldTranslate('WebApp.AddToAttachmentUnavailableError'),\n      tabId,\n    });\n\n    return undefined;\n  }\n  setGlobal(global);\n\n  return result.bot;\n}\n\nasync function openChatByUsername<T extends GlobalState>(\n  global: T,\n  actions: RequiredGlobalActions,\n  params: {\n    username: string;\n    threadId?: ThreadId;\n    channelPostId?: number;\n    startParam?: string;\n    ref?: string;\n    startAttach?: string;\n    attach?: string;\n    text?: string;\n    timestamp?: number;\n    linkContext?: LinkContext;\n    isDirect?: boolean;\n  },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const {\n    username, threadId, channelPostId, startParam, ref, startAttach, attach, text, timestamp,\n    linkContext, isDirect,\n  } = params;\n  const currentChat = selectCurrentChat(global, tabId);\n\n  // Attach in the current chat\n  if (startAttach !== undefined && !attach) {\n    const bot = await getAttachBotOrNotify(global, actions, username, tabId);\n\n    if (!bot) return;\n\n    actions.callAttachBot({\n      bot,\n      chatId: currentChat?.id || bot.id,\n      startParam: startAttach,\n      tabId,\n    });\n\n    return;\n  }\n\n  const localChat = selectChatByUsername(global, username);\n  const localDirectChat = isDirect && localChat?.linkedMonoforumId && !localChat.isMonoforum\n    ? selectChat(global, localChat.linkedMonoforumId) : undefined;\n\n  const isCurrentChat = !isDirect\n    ? currentChat?.usernames?.some((c) => c.username === username)\n    : localDirectChat?.id === currentChat?.id;\n\n  if (!isCurrentChat) {\n    // Open temporary empty chat to make the click response feel faster\n    actions.openChat({ id: TMP_CHAT_ID, tabId });\n  }\n\n  const starRefStartPrefixes = global.appConfig.starRefStartPrefixes;\n  let referrer = ref;\n  if (startParam && starRefStartPrefixes?.length) {\n    const prefix = starRefStartPrefixes.find((p) => startParam.startsWith(p));\n    if (prefix) {\n      referrer = startParam.slice(prefix.length);\n    }\n  }\n\n  const chat = await fetchChatByUsername(global, username, referrer);\n  if (!chat) {\n    if (!isCurrentChat) {\n      actions.openPreviousChat({ tabId });\n      actions.showNotification({ message: 'User does not exist', tabId });\n    }\n\n    return;\n  }\n\n  const monoforumChat = isDirect && !chat.isMonoforum && chat.linkedMonoforumId\n    ? selectChat(global, chat.linkedMonoforumId) : undefined;\n\n  const targetChat = (isDirect && monoforumChat) || chat;\n\n  openChatWithParams(global, actions, targetChat, {\n    isCurrentChat,\n    threadId,\n    messageId: channelPostId,\n    startParam,\n    referrer,\n    startAttach,\n    attach,\n    text,\n    timestamp,\n    linkContext,\n  }, tabId);\n}\n\nasync function openChatWithParams<T extends GlobalState>(\n  global: T,\n  actions: RequiredGlobalActions,\n  chat: ApiChat,\n  params: {\n    isCurrentChat?: boolean;\n    threadId?: ThreadId;\n    messageId?: number;\n    startParam?: string;\n    referrer?: string;\n    startAttach?: string;\n    attach?: string;\n    text?: string;\n    timestamp?: number;\n    linkContext?: LinkContext;\n  },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const {\n    isCurrentChat, threadId, messageId, startParam, referrer, startAttach, attach, text, timestamp,\n    linkContext,\n  } = params;\n\n  if (messageId) {\n    let isTopicProcessed = false;\n    // In forums, link to a topic start message should open the topic\n    if (chat.isForum && !threadId) {\n      let topic = selectTopics(global, chat.id)?.[messageId];\n      if (!topic) {\n        const topicResult = await callApi('fetchTopicById', { chat, topicId: messageId });\n        topic = topicResult?.topic;\n      }\n\n      if (topic) {\n        actions.openThread({\n          chatId: chat.id, threadId: topic.id, tabId,\n        });\n        isTopicProcessed = true;\n      }\n    }\n\n    if (!isTopicProcessed) {\n      actions.focusMessage({\n        chatId: chat.id, threadId, messageId, timestamp, tabId,\n        replyMessageId: linkContext?.messageId,\n      });\n    }\n  } else if (!isCurrentChat) {\n    actions.openThread({ chatId: chat.id, threadId: threadId ?? MAIN_THREAD_ID, tabId });\n  }\n\n  if (startParam && !referrer) {\n    actions.startBot({ botId: chat.id, param: startParam });\n  }\n\n  if (attach) {\n    global = getGlobal();\n    openAttachMenuFromLink(global, actions, chat.id, attach, startAttach, tabId);\n  }\n\n  if (text) {\n    actions.openChatWithDraft({ chatId: chat.id, text: { text }, tabId });\n  }\n\n  if (messageId && timestamp) {\n    actions.openMediaFromTimestamp({\n      chatId: chat.id, threadId, messageId, timestamp, tabId,\n    });\n  }\n}\n\nasync function openAttachMenuFromLink<T extends GlobalState>(\n  global: T,\n  actions: RequiredGlobalActions,\n  chatId: string,\n  attach: string,\n  startAttach?: string | boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  global = getGlobal();\n  const bot = await getAttachBotOrNotify(global, actions, attach, tabId);\n  if (!bot) return;\n\n  actions.callAttachBot({\n    bot,\n    chatId,\n    ...(typeof startAttach === 'string' && { startParam: startAttach }),\n    tabId,\n  });\n}\n\nexport async function ensureIsSuperGroup<T extends GlobalState>(\n  global: T,\n  actions: RequiredGlobalActions,\n  chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat || !isChatBasicGroup(chat)) {\n    return chat;\n  }\n\n  const newChat = await migrateChat(global, actions, chat, tabId);\n  if (!newChat) {\n    return undefined;\n  }\n\n  actions.loadFullChat({ chatId: newChat.id });\n  actions.openChat({ id: newChat.id, tabId });\n\n  return newChat;\n}\n","import type { ApiGroupCall } from '../../../api/types';\nimport type { CallSound } from '../../../types';\nimport type { RequiredGlobalActions } from '../../index';\nimport type {\n  ActionReturnType, GlobalState, TabArgs,\n} from '../../types';\n\nimport { requestNextMutation } from '../../../lib/fasterdom/fasterdom';\nimport { ARE_CALLS_SUPPORTED } from '../../../util/browser/windowEnvironment';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { omit } from '../../../util/iteratees';\nimport * as langProvider from '../../../util/oldLangProvider';\nimport safePlay from '../../../util/safePlay';\nimport { callApi } from '../../../api/gramjs';\nimport { getMainUsername } from '../../helpers';\nimport {\n  addActionHandler, getGlobal,\n  setGlobal,\n} from '../../index';\nimport { updateGroupCall } from '../../reducers/calls';\nimport { updateTabState } from '../../reducers/tabs';\nimport {\n  selectChat, selectChatFullInfo, selectIsCurrentUserFrozen,\n  selectTabState, selectUser,\n} from '../../selectors';\nimport { selectActiveGroupCall, selectChatGroupCall, selectGroupCall } from '../../selectors/calls';\nimport { fetchChatByUsername, loadFullChat } from '../api/chats';\n\n// This is a tiny MP3 file that is silent - retrieved from https://bigsoundbank.com and then modified\n// eslint-disable-next-line @stylistic/max-len\nconst silentSound = 'data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV';\n\nlet audioElement: HTMLAudioElement | undefined;\nlet audioContext: AudioContext | undefined;\nlet sounds: Record<CallSound, HTMLAudioElement>;\n\n// Workaround: this function is called once on the first user interaction.\n// After that, it will be possible to play the notification on iOS without problems.\n// https://rosswintle.uk/2019/01/skirting-the-ios-safari-audio-auto-play-policy-for-ui-sound-effects/\nexport function initializeSoundsForSafari() {\n  initializeSounds();\n\n  return Promise.all(Object.values(sounds).map((sound) => {\n    const prevSrc = sound.src;\n    sound.src = silentSound;\n    sound.muted = true;\n    sound.volume = 0.0001;\n    return sound.play()\n      .then(() => {\n        sound.pause();\n        sound.volume = 1;\n        sound.currentTime = 0;\n        sound.muted = false;\n\n        requestNextMutation(() => {\n          sound.src = prevSrc;\n        });\n      });\n  }));\n}\n\nexport function initializeSounds() {\n  if (sounds) {\n    return;\n  }\n  const joinAudio = new Audio('./voicechat_join.mp3');\n  const connectingAudio = new Audio('./voicechat_connecting.mp3');\n  connectingAudio.loop = true;\n  const leaveAudio = new Audio('./voicechat_leave.mp3');\n  const allowTalkAudio = new Audio('./voicechat_onallowtalk.mp3');\n  const busyAudio = new Audio('./call_busy.mp3');\n  const connectAudio = new Audio('./call_connect.mp3');\n  const endAudio = new Audio('./call_end.mp3');\n  const incomingAudio = new Audio('./call_incoming.mp3');\n  incomingAudio.loop = true;\n  const ringingAudio = new Audio('./call_ringing.mp3');\n  ringingAudio.loop = true;\n\n  sounds = {\n    join: joinAudio,\n    allowTalk: allowTalkAudio,\n    leave: leaveAudio,\n    connecting: connectingAudio,\n    incoming: incomingAudio,\n    end: endAudio,\n    connect: connectAudio,\n    busy: busyAudio,\n    ringing: ringingAudio,\n  };\n}\n\nasync function fetchGroupCall<T extends GlobalState>(global: T, groupCall: Partial<ApiGroupCall>) {\n  if (selectIsCurrentUserFrozen(global)) return undefined;\n  const result = await callApi('getGroupCall', {\n    call: groupCall,\n  });\n\n  if (!result) return undefined;\n\n  global = getGlobal();\n\n  const existingGroupCall = selectGroupCall(global, groupCall.id!);\n\n  global = updateGroupCall(\n    global,\n    groupCall.id!,\n    omit(result.groupCall, ['connectionState']),\n    undefined,\n    existingGroupCall?.isLoaded ? undefined : result.groupCall.participantsCount,\n  );\n\n  setGlobal(global);\n\n  return result.groupCall;\n}\n\nfunction requestGroupCallParticipants(\n  groupCall: Partial<ApiGroupCall>, nextOffset?: string,\n) {\n  return callApi('fetchGroupCallParticipants', {\n    call: groupCall as ApiGroupCall,\n    offset: nextOffset,\n  });\n}\n\naddActionHandler('toggleGroupCallPanel', (global, actions, payload): ActionReturnType => {\n  const { force, tabId = getCurrentTabId() } = payload || {};\n  return updateTabState(global, {\n    isCallPanelVisible: 'force' in (payload || {}) ? force : !selectTabState(global, tabId).isCallPanelVisible,\n  }, tabId);\n});\n\naddActionHandler('createGroupCall', async (global, actions, payload): Promise<void> => {\n  const { chatId, tabId = getCurrentTabId() } = payload;\n\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const result = await callApi('createGroupCall', {\n    peer: chat,\n  });\n\n  if (!result) return;\n\n  global = getGlobal();\n  global = updateGroupCall(global, result.id, {\n    ...result,\n    chatId,\n  });\n  setGlobal(global);\n\n  actions.requestMasterAndJoinGroupCall({ id: result.id, accessHash: result.accessHash, tabId });\n});\n\naddActionHandler('createGroupCallInviteLink', async (global, actions, payload): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  const groupCall = selectActiveGroupCall(global);\n\n  if (!groupCall || !groupCall.chatId) {\n    return;\n  }\n\n  const chat = selectChat(global, groupCall.chatId);\n  if (!chat) {\n    return;\n  }\n\n  const hasPublicUsername = Boolean(getMainUsername(chat));\n\n  let inviteLink = selectChatFullInfo(global, chat.id)?.inviteLink;\n  if (hasPublicUsername) {\n    inviteLink = await callApi('exportGroupCallInvite', {\n      call: groupCall,\n      canSelfUnmute: false,\n    });\n  }\n\n  if (!inviteLink) {\n    return;\n  }\n\n  copyTextToClipboard(inviteLink);\n  actions.showNotification({\n    message: {\n      key: 'LinkCopied',\n    },\n    tabId,\n  });\n});\n\naddActionHandler('joinVoiceChatByLink', async (global, actions, payload): Promise<void> => {\n  const { username, inviteHash, tabId = getCurrentTabId() } = payload;\n\n  const chat = await fetchChatByUsername(global, username);\n\n  if (!chat) {\n    actions.showNotification({ message: langProvider.oldTranslate('NoUsernameFound'), tabId });\n    return;\n  }\n\n  global = getGlobal();\n  const full = await loadFullChat(global, actions, chat);\n\n  if (full?.groupCall) {\n    actions.requestMasterAndJoinGroupCall({\n      id: full.groupCall.id,\n      accessHash: full.groupCall.accessHash,\n      inviteHash,\n      tabId,\n    });\n  }\n});\n\naddActionHandler('requestMasterAndJoinGroupCall', (global, actions, payload): ActionReturnType => {\n  actions.requestMasterAndCallAction({\n    action: 'joinGroupCall',\n    payload,\n    tabId: payload.tabId || getCurrentTabId(),\n  });\n});\n\naddActionHandler('requestMasterAndAcceptCall', (global, actions, payload): ActionReturnType => {\n  actions.requestMasterAndCallAction({\n    action: 'acceptCall',\n    payload: undefined,\n    tabId: payload?.tabId || getCurrentTabId(),\n  });\n});\n\naddActionHandler('joinGroupCall', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, id, accessHash, inviteHash, tabId = getCurrentTabId(),\n  } = payload;\n\n  if (!ARE_CALLS_SUPPORTED) {\n    actions.showNotification({\n      message: 'Sorry, your browser doesn\\'t support group calls',\n      tabId,\n    });\n    return;\n  }\n\n  if (global.phoneCall) {\n    actions.toggleGroupCallPanel({ tabId });\n    return;\n  }\n\n  createAudioElement();\n\n  initializeSounds();\n  global = getGlobal();\n  void checkNavigatorUserMediaPermissions(global, actions, true, tabId);\n\n  const { groupCalls: { activeGroupCallId } } = global;\n  let groupCall = id ? selectGroupCall(global, id) : selectChatGroupCall(global, chatId!);\n\n  if (groupCall && groupCall.id === activeGroupCallId) {\n    actions.toggleGroupCallPanel({ tabId });\n    return;\n  }\n\n  if (activeGroupCallId) {\n    if ('leaveGroupCall' in actions) {\n      actions.leaveGroupCall({\n        rejoin: payload,\n        tabId,\n      });\n    }\n    return;\n  }\n\n  if (groupCall && activeGroupCallId === groupCall.id) {\n    actions.toggleGroupCallPanel({ tabId });\n    return;\n  }\n\n  if (!groupCall && (!id || !accessHash) && chatId) {\n    const chat = selectChat(global, chatId);\n\n    if (!chat) return;\n\n    await loadFullChat(global, actions, chat);\n    global = getGlobal();\n    groupCall = selectChatGroupCall(global, chatId);\n  } else if (!groupCall && id && accessHash) {\n    groupCall = await fetchGroupCall(global, {\n      id,\n      accessHash,\n    });\n  }\n\n  if (!groupCall) return;\n\n  global = getGlobal();\n  global = updateGroupCall(\n    global,\n    groupCall.id,\n    {\n      ...groupCall,\n      inviteHash,\n    },\n    undefined,\n    groupCall.participantsCount + 1,\n  );\n  global = {\n    ...global,\n    groupCalls: {\n      ...global.groupCalls,\n      activeGroupCallId: groupCall.id,\n    },\n  };\n\n  setGlobal(global);\n\n  actions.toggleGroupCallPanel({ force: false, tabId });\n});\n\naddActionHandler('playGroupCallSound', (global, actions, payload): ActionReturnType => {\n  const { sound } = payload;\n\n  if (!sounds?.[sound]) {\n    return;\n  }\n\n  const doPlay = () => {\n    if (sound !== 'connecting') {\n      sounds.connecting.pause();\n    }\n    if (sound !== 'incoming') {\n      sounds.incoming.pause();\n    }\n    if (sound !== 'ringing') {\n      sounds.ringing.pause();\n    }\n    safePlay(sounds[sound]);\n  };\n\n  doPlay();\n});\n\naddActionHandler('loadMoreGroupCallParticipants', (global): ActionReturnType => {\n  const groupCall = selectActiveGroupCall(global);\n  if (!groupCall) {\n    return;\n  }\n\n  void requestGroupCallParticipants(groupCall, groupCall.nextOffset);\n});\n\naddActionHandler('requestMasterAndRequestCall', (global, actions, payload): ActionReturnType => {\n  actions.requestMasterAndCallAction({\n    action: 'requestCall',\n    payload,\n    tabId: payload.tabId || getCurrentTabId(),\n  });\n});\n\naddActionHandler('requestCall', (global, actions, payload): ActionReturnType => {\n  const { userId, isVideo, tabId = getCurrentTabId() } = payload;\n\n  if (global.phoneCall) {\n    actions.toggleGroupCallPanel({ tabId });\n    return;\n  }\n\n  const user = selectUser(global, userId);\n\n  if (!user) {\n    return;\n  }\n\n  initializeSounds();\n  global = getGlobal();\n  void checkNavigatorUserMediaPermissions(global, actions, isVideo, tabId);\n\n  global = getGlobal();\n  global = {\n    ...global,\n    phoneCall: {\n      id: '',\n      state: 'requesting',\n      participantId: userId,\n      isVideo,\n      adminId: global.currentUserId,\n    },\n  };\n  setGlobal(global);\n\n  actions.toggleGroupCallPanel({ force: false, tabId });\n});\n\nfunction createAudioContext() {\n  return (new (window.AudioContext || (window as any).webkitAudioContext)());\n}\n\nconst silence = (ctx: AudioContext) => {\n  const oscillator = ctx.createOscillator();\n  const dst = oscillator.connect(ctx.createMediaStreamDestination());\n  oscillator.start();\n  return new MediaStream([Object.assign((dst as any).stream.getAudioTracks()[0], { enabled: false })]);\n};\n\nfunction createAudioElement() {\n  const ctx = createAudioContext();\n  audioElement = new Audio();\n  audioContext = ctx;\n  audioElement.srcObject = silence(ctx);\n  safePlay(audioElement);\n}\n\nexport function getGroupCallAudioElement() {\n  return audioElement;\n}\n\nexport function getGroupCallAudioContext() {\n  return audioContext;\n}\n\nexport function removeGroupCallAudioElement() {\n  audioElement?.pause();\n  audioContext = undefined;\n  audioElement = undefined;\n}\n\n// This method is used instead of a navigator.permissions.query to determine permission to use a microphone,\n// because Firefox does not have support for 'microphone' and 'camera' permissions\n// https://github.com/mozilla/standards-positions/issues/19#issuecomment-370158947\nexport function checkNavigatorUserMediaPermissions<T extends GlobalState>(\n  global: T,\n  actions: RequiredGlobalActions, isVideo?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (isVideo) {\n    navigator.mediaDevices.getUserMedia({ video: true })\n      .then((stream) => {\n        if (stream.getVideoTracks().length === 0) {\n          actions.showNotification({\n            message: langProvider.oldTranslate('Call.Camera.Error'),\n            tabId,\n          });\n        } else {\n          stream.getTracks().forEach((track) => track.stop());\n          checkMicrophonePermission(global, actions, tabId);\n        }\n      })\n      .catch(() => {\n        actions.showNotification({\n          message: langProvider.oldTranslate('Call.Camera.Error'),\n          tabId,\n        });\n      });\n  } else {\n    checkMicrophonePermission(global, actions, tabId);\n  }\n}\n\nfunction checkMicrophonePermission<T extends GlobalState>(\n  global: T, actions: RequiredGlobalActions, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  navigator.mediaDevices.getUserMedia({ audio: true })\n    .then((stream) => {\n      if (stream.getAudioTracks().length === 0) {\n        actions.showNotification({\n          message: langProvider.oldTranslate('RequestAcces.Error.HaveNotAccess.Call'),\n          tabId,\n        });\n      } else {\n        stream.getTracks().forEach((track) => track.stop());\n      }\n    })\n    .catch(() => {\n      actions.showNotification({\n        message: langProvider.oldTranslate('RequestAcces.Error.HaveNotAccess.Call'),\n        tabId,\n      });\n    });\n}\n","import type { ApiGroupCall } from '../../api/types';\nimport type { GroupCallParticipant } from '../../lib/secret-sauce';\nimport type { GlobalState } from '../types';\n\nimport { omit } from '../../util/iteratees';\nimport { selectChat } from '../selectors';\nimport { selectGroupCall } from '../selectors/calls';\nimport { updateChatFullInfo } from './chats';\n\nexport function updateGroupCall<T extends GlobalState>(\n  global: T,\n  groupCallId: string,\n  groupCallUpdate: Partial<ApiGroupCall>,\n  addToParticipantCount?: number,\n  resetParticipantCount?: number,\n): T {\n  const unfiltered = Object.values({\n    ...global.groupCalls.byId[groupCallId]?.participants,\n    ...groupCallUpdate.participants,\n  });\n  const filtered = unfiltered.filter(({ isLeft }) => !isLeft);\n  const participants = filtered.reduce((acc: Record<string, GroupCallParticipant>, el) => {\n    acc[el.id] = el;\n    return acc;\n  }, {});\n\n  return {\n    ...global,\n    groupCalls: {\n      ...global.groupCalls,\n      byId: {\n        ...global.groupCalls.byId,\n        [groupCallId]: {\n          ...global.groupCalls.byId[groupCallId],\n          ...omit(groupCallUpdate, ['participantsCount']),\n          ...(addToParticipantCount && {\n            participantsCount: global.groupCalls.byId[groupCallId].participantsCount + addToParticipantCount,\n          }),\n          ...(resetParticipantCount !== undefined && {\n            participantsCount: resetParticipantCount,\n          }),\n          participants,\n        },\n      },\n    },\n  };\n}\n\nexport function removeGroupCall<T extends GlobalState>(\n  global: T,\n  groupCallId: string,\n): T {\n  const groupCall = selectGroupCall(global, groupCallId);\n  if (groupCall && groupCall.chatId) {\n    const chat = selectChat(global, groupCall.chatId);\n    if (chat) {\n      global = updateChatFullInfo(global, groupCall.chatId, {\n        groupCallId: undefined,\n      });\n    }\n  }\n\n  return {\n    ...global,\n    groupCalls: {\n      ...global.groupCalls,\n      byId: {\n        ...omit(global.groupCalls.byId, [groupCallId.toString()]),\n      },\n    },\n  };\n}\n\nexport function updateActiveGroupCall<T extends GlobalState>(\n  global: T,\n  groupCallUpdate: Partial<ApiGroupCall>,\n  resetParticipantCount?: number,\n): T {\n  if (!global.groupCalls.activeGroupCallId) {\n    return global;\n  }\n\n  return updateGroupCall(global,\n    global.groupCalls.activeGroupCallId,\n    groupCallUpdate,\n    undefined,\n    resetParticipantCount);\n}\n\nexport function updateGroupCallParticipant<T extends GlobalState>(\n  global: T,\n  groupCallId: string,\n  userId: string,\n  participantUpdate: Partial<GroupCallParticipant>,\n  noUpdateCount = false,\n): T {\n  const groupCall = selectGroupCall(global, groupCallId);\n  if (!groupCall) {\n    return global;\n  }\n\n  return updateGroupCall(global, groupCallId, {\n    participants: {\n      ...groupCall.participants,\n      [userId]: {\n        ...groupCall.participants[userId],\n        ...participantUpdate,\n      },\n    },\n  }, participantUpdate.isLeft\n    ? (noUpdateCount ? 0 : -1)\n    : (groupCall.participants[userId] || noUpdateCount ? 0 : 1));\n}\n"],"names":["MAIN_THREAD_ID","ChatCreationProgress","ManagementProgress","NewChatMembersProgress","SettingsScreens","ALL_FOLDER_ID","ARCHIVED_FOLDER_ID","CHAT_LIST_LOAD_SLICE","DEBUG","GLOBAL_SUGGESTED_CHANNELS_ID","RE_TG_LINK","SAVED_FOLDER_ID","SERVICE_NOTIFICATIONS_USER_ID","TME_WEB_DOMAINS","TMP_CHAT_ID","TOP_CHAT_MESSAGES_PRELOAD_LIMIT","TOPICS_SLICE","TOPICS_SLICE_SECOND_LOAD","copyTextToClipboard","formatShareText","processDeepLink","isDeepLink","isUserId","getCurrentTabId","getOrderedIds","buildCollectionByKey","omit","pick","unique","isLocalMessageId","langProvider","debounce","pause","throttle","extractCurrentThemeParams","callApi","getIsSavedDialog","isChatArchived","isChatBasicGroup","isChatChannel","isChatMonoforum","isChatSuperGroup","isUserBot","addActionHandler","getGlobal","setGlobal","addChatListIds","addChatMembers","addChats","addMessages","addNotifyExceptions","addSimilarBots","addUsers","addUserStatuses","deleteChatMessages","deletePeerPhoto","deleteTopic","leaveChat","removeChatFromChatLists","replaceChatFullInfo","replaceChatListIds","replaceChatListLoadingParameters","replaceMessages","replaceNotifyExceptions","replaceSimilarChannels","replaceThreadParam","replaceUserStatuses","toggleSimilarChannels","updateChat","updateChatFullInfo","updateChatLastMessageId","updateChatListSecondaryInfo","updateChats","updateChatsLastMessageId","updateListedTopicIds","updateManagementProgress","updateMissingInvitedUsers","updatePeerFullInfo","updateThread","updateThreadInfo","updateTopic","updateTopics","updateUser","updateUsers","updateGroupCall","updateTabState","selectChat","selectChatByUsername","selectChatFolder","selectChatFullInfo","selectChatLastMessageId","selectChatListLoadingParameters","selectChatListType","selectChatMessages","selectCurrentChat","selectCurrentMessageList","selectDraft","selectIsChatPinned","selectIsChatWithSelf","selectIsCurrentUserFrozen","selectLastServiceNotification","selectPeer","selectPeerFullInfo","selectSimilarChannelIds","selectStickerSet","selectSupportChat","selectTabState","selectThread","selectThreadInfo","selectTopic","selectTopics","selectTopicsInfo","selectUser","selectUserByPhoneNumber","selectGroupCall","selectCurrentLimit","TOP_CHAT_MESSAGES_PRELOAD_INTERVAL","INFINITE_LOOP_MARKER","CHATLIST_LIMIT_ERROR_LIST","Set","runThrottledForLoadTopChats","cb","runDebouncedForLoadFullChat","global","actions","preloadedChatIds","i","currentChatIds","Object","values","byTabId","map","id","tabId","chatId","filter","Boolean","folderAllOrderedIds","nextChatId","find","includes","has","add","loadViewportMessages","threadId","abortChatRequests","abortChatRequestsForCurrentChat","newChatId","newThreadId","currentMessageList","currentChatId","currentThreadId","isChatOpened","isThreadOpened","reduce","accHasChatOpened","accHasThreadOpened","otherTabId","otherMessageList","isSameChat","isSameThread","shouldAbortChatRequests","undefined","payload","type","noForumTopicPanel","shouldReplaceHistory","shouldReplaceLast","processOpenChatOrThread","chat","hasUnreadMark","markChatRead","isChatOnlySummary","user","isMin","requestChatUpdate","otherParams","openThread","currentUserId","isComments","focusMessageId","loadingChatId","loadingThreadId","originalChat","openChat","isForum","originChannelId","originMessageId","threadInfo","thread","listedIds","length","Number","loadingThread","loadingMessageId","openPreviousChat","currentGlobal","result","messageId","showNotification","message","oldTranslate","messages","lastMessageId","messagesCount","isCommentsInfo","fromChannelId","fromMessageId","firstMessageId","focusMessage","onError","onLoaded","chatFullInfo","fullInfo","linkedChatId","whenFirstBatchDone","listType","isCallbackFired","chats","isFullyLoaded","console","error","connectionState","auth","state","loadChats","dialogIds","users","orderedPinnedIds","force","withPhotos","loadChat","loadFullChat","loadMoreProfilePhotos","peerId","shouldInvalidateCache","isUser","fullInfoById","lastLocalMessage","isSavedDialog","limit","forEach","tabChatId","mutedUntil","openFrozenAccountModal","settings","isEnabled","isSilentPosting","topicId","title","about","photo","memberIds","discussionChannelId","isChannel","isSuperGroup","chatCreation","progress","InProgress","createdChannel","missingInvitedUsers","isBroadcast","isMegagroup","channel","missingUsers","Error","openLimitReachedModal","showDialog","data","hasErrorKey","channelId","accessHash","Complete","linkDiscussionGroup","userId","shouldRevokeHistory","chatMessages","localMessageIds","keys","createdChat","err","folderId","folder","shouldBePinned","pinnedChatIds","includedChatIds","newPinnedIds","pinnedId","newIncludedChatIds","folderUpdate","isPinned","ids","saved","chatFolders","recommendedChatFolders","recommended","areTagsEnabled","idsToRemove","idsToAdd","isLimitReached","some","includedId","concat","emoticon","orderedIds","byId","maxId","Math","max","recommendedId","description","newFolder","newId","apiUpdate","requestNextFoldersAction","foldersAction","folderIds","readAllMentions","readAllReactions","hasMoreTopics","lastTopic","processedCount","offsetDate","date","offsetTopicId","offsetId","topics","topic","unreadCount","unreadMentionsCount","unreadReactionsCount","markTopicRead","count","lastTopicMessageId","lastReadInboxMessageId","hash","invite","subscriptionFormId","starsPayment","inputInvoice","subscriptionInfo","status","chatInviteModal","inviteInfo","phoneNumber","startAttach","attach","text","fetchChatByPhoneNumber","replace","openChatWithDraft","openAttachMenuFromLink","url","shouldIgnoreCache","linkContext","openChatByPhoneNumber","checkChatInvite","openStickerSet","joinVoiceChatByLink","openInvoice","checkChatlistInvite","openChatByUsername","openChatByUsernameAction","openStoryViewerByUsername","checkGiftCode","isProcessed","match","uri","URL","toLowerCase","startsWith","hostname","pathname","window","open","toString","hostParts","split","adaptedPathname","part1","part2","part3","part","decodeURI","params","fromEntries","searchParams","storyId","substr","startattach","username","stickerSetInfo","shortName","slug","chatOrChannelPostId","commentId","comment","isWebApp","checkWebAppExists","shouldTryOpenChat","isInteger","hasOwnProperty","inviteHash","voicechat","livestream","substring","startParam","start","startApp","startapp","mode","originalParts","openUrl","shouldSkipModal","ignoreDeepLinks","usernameOrId","isPrivate","key","fetchChatByUsername","openBoostModal","shouldStartMainApp","isDirect","onChatChanged","choose","ref","timestamp","webAppName","usernames","c","processAttachBotParameters","theme","chatByUsername","hasMainMiniApp","requestMainWebView","botId","channelPostId","action","usernameChat","openMediaFromTimestamp","requestAppWebView","appName","openChatWithParams","ensureIsSuperGroup","isPreHistoryHidden","bannedRights","updatedFullInfo","members","kickedMembers","isBanned","viewMessages","isUnblocked","m","membersCount","adminRights","customTitle","chatAfterUpdate","adminMembersById","isDismissed","newAdminMembersById","remove","rest","Promise","all","isDeleted","avatarPhotoId","areProfilesEnabled","areSignaturesEnabled","groups","addedById","group","forDiscussionIds","fullChat","activeChatFolder","maxFolders","isBlocked","requestedDraft","offset","userStatusesById","setNewChatMembersDialogState","newChatMembersProgress","Loading","Closed","updateChatMemberBannedRights","sendMessages","sendMedia","sendStickers","sendGifs","sendGames","sendInline","embedLinks","sendPolls","changeInfo","inviteUsers","pinMessages","manageTopics","sendPhotos","sendVideos","sendRoundvideos","sendAudios","sendVoices","sendDocs","sendPlain","isProtected","enabledReactions","reactionsLimit","toggleStoryRibbon","isShown","isArchived","forumPanelChatId","bot","getAttachBotOrNotify","isForChat","callAttachBot","isFromSideMenu","attachMenu","bots","requestedAttachBotInstall","onConfirm","requestAttachBotInChat","topicsInfo","listedTopicIds","totalCount","offsetTopic","acc","el","accTopic","entries","draftsById","draft","readInboxMessageIdByTopicId","shouldCloseChatOnError","closeForumPanel","openForumPanel","prevIsEnabled","areParticipantsHidden","iconColor","iconEmojiId","createTopicPanel","isLoading","closeCreateTopicPanel","editTopicPanel","closeEditTopicPanel","topicsPinnedLimit","appConfig","chatlistModal","peerIds","peers","currentNotJoinedCount","peer","isNotJoined","existingFolder","folderTitle","variables","options","pluralValue","invites","shareFolderScreen","openSettingsScreen","screen","Folders","pop","isConfirmedForChatlist","isChatList","hasMyInvites","currentIds","suggestions","removal","suggestedPeerIds","deleteFolderDialogModal","detectedLanguage","isTranslationDisabled","isForumAsMessages","similarChannelIds","similarChannels","chatsById","similarBots","paidMessagesStars","hasAutoTranslation","tab","peerFullInfo","oldMainTab","mainTab","chatLink","collectible","inputCollectible","phone","collectibleInfoModal","isFullDraftSync","shouldIgnorePagination","lastLocalServiceMessageId","offsetPeer","nextOffsetPeerId","nextOffsetDate","nextOffsetId","isFirstBatch","shouldReplaceStaleState","isAccountFreeze","withPinned","archived","chatIds","newChats","notifyExceptionById","lastMessageByChatId","idsToUpdateDraft","isLocal","totalChatCount","groupCall","existingGroupCall","participantsCount","stickerSet","localSet","loadStickers","emojiSet","localEmojiSet","migrateChat","supergroup","referrer","localChat","botName","botApp","localUser","isBot","currentChat","localDirectChat","linkedMonoforumId","isMonoforum","isCurrentChat","starRefStartPrefixes","prefix","p","slice","monoforumChat","targetChat","isTopicProcessed","topicResult","replyMessageId","startBot","param","newChat","requestNextMutation","ARE_CALLS_SUPPORTED","safePlay","getMainUsername","selectActiveGroupCall","selectChatGroupCall","silentSound","audioElement","audioContext","sounds","initializeSoundsForSafari","initializeSounds","sound","prevSrc","src","muted","volume","play","then","currentTime","joinAudio","Audio","connectingAudio","loop","leaveAudio","allowTalkAudio","busyAudio","connectAudio","endAudio","incomingAudio","ringingAudio","join","allowTalk","leave","connecting","incoming","end","connect","busy","ringing","fetchGroupCall","call","isLoaded","requestGroupCallParticipants","nextOffset","isCallPanelVisible","requestMasterAndJoinGroupCall","hasPublicUsername","inviteLink","canSelfUnmute","full","requestMasterAndCallAction","phoneCall","toggleGroupCallPanel","createAudioElement","checkNavigatorUserMediaPermissions","groupCalls","activeGroupCallId","leaveGroupCall","rejoin","doPlay","isVideo","participantId","adminId","createAudioContext","AudioContext","webkitAudioContext","silence","ctx","oscillator","createOscillator","dst","createMediaStreamDestination","MediaStream","assign","stream","getAudioTracks","enabled","srcObject","getGroupCallAudioElement","getGroupCallAudioContext","removeGroupCallAudioElement","navigator","mediaDevices","getUserMedia","video","getVideoTracks","getTracks","track","stop","checkMicrophonePermission","catch","audio","groupCallId","groupCallUpdate","addToParticipantCount","resetParticipantCount","unfiltered","participants","filtered","isLeft","removeGroupCall","updateActiveGroupCall","updateGroupCallParticipant","participantUpdate","noUpdateCount"],"sourceRoot":""}