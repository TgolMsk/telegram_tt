{"version":3,"file":"src_global_helpers_payments_ts-src_hooks_useContextMenuHandlers_ts-src_hooks_useLayoutEffectW-2aec7a.ab1577b480a3ac23f2bc.js","mappings":"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","sources":["webpack://telegram-t/./src/global/helpers/payments.ts","webpack://telegram-t/./src/hooks/useContextMenuHandlers.ts","webpack://telegram-t/./src/hooks/useLayoutEffectWithPrevDeps.ts","webpack://telegram-t/./src/util/directInputManager.ts","webpack://telegram-t/./src/util/trapFocus.ts"],"sourcesContent":["import type {\n  ApiInputInvoice,\n  ApiInputSavedStarGift,\n  ApiMessage,\n  ApiRequestInputInvoice,\n  ApiRequestInputSavedStarGift,\n  ApiStarsAmount,\n  ApiStarsTransaction,\n  ApiTypeCurrencyAmount,\n} from '../../api/types';\nimport type { CustomPeer } from '../../types';\nimport type { LangFn } from '../../util/localization';\nimport type { GlobalState } from '../types';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../config';\nimport arePropsShallowEqual from '../../util/arePropsShallowEqual';\nimport { convertTonFromNanos } from '../../util/formatCurrency';\nimport { selectChat, selectPeer, selectUser } from '../selectors';\n\nexport function getRequestInputInvoice<T extends GlobalState>(\n  global: T, inputInvoice: ApiInputInvoice,\n): ApiRequestInputInvoice | undefined {\n  if (inputInvoice.type === 'slug') return inputInvoice;\n\n  if (inputInvoice.type === 'stargiftResale') {\n    const {\n      slug,\n      peerId,\n    } = inputInvoice;\n    const peer = selectPeer(global, peerId);\n\n    if (!peer) return undefined;\n\n    return {\n      type: 'stargiftResale',\n      slug,\n      peer,\n      currency: inputInvoice.currency,\n    };\n  }\n\n  if (inputInvoice.type === 'stargift') {\n    const {\n      peerId, shouldHideName, giftId, message, shouldUpgrade,\n    } = inputInvoice;\n    const peer = selectPeer(global, peerId);\n\n    if (!peer) return undefined;\n\n    return {\n      type: 'stargift',\n      peer,\n      shouldHideName,\n      giftId,\n      message,\n      shouldUpgrade,\n    };\n  }\n\n  if (inputInvoice.type === 'starsgift') {\n    const {\n      userId, stars, amount, currency,\n    } = inputInvoice;\n    const user = selectUser(global, userId);\n\n    if (!user) return undefined;\n\n    return {\n      type: 'stars',\n      purpose: {\n        type: 'starsgift',\n        user,\n        stars,\n        amount,\n        currency,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'stars') {\n    const {\n      stars, amount, currency, spendPurposePeerId,\n    } = inputInvoice;\n\n    const spendPurposePeer = spendPurposePeerId ? selectPeer(global, spendPurposePeerId) : undefined;\n\n    return {\n      type: 'stars',\n      purpose: {\n        type: 'stars',\n        stars,\n        amount,\n        currency,\n        spendPurposePeer,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'chatInviteSubscription') {\n    const { hash } = inputInvoice;\n\n    return {\n      type: 'chatInviteSubscription',\n      hash,\n    };\n  }\n\n  if (inputInvoice.type === 'message') {\n    const chat = selectChat(global, inputInvoice.chatId);\n    if (!chat) {\n      return undefined;\n    }\n    return {\n      type: 'message',\n      chat,\n      messageId: inputInvoice.messageId,\n    };\n  }\n\n  if (inputInvoice.type === 'premiumGiftStars') {\n    const {\n      months, userId, message,\n    } = inputInvoice;\n    const user = selectUser(global, userId);\n\n    if (!user) return undefined;\n\n    return {\n      type: 'premiumGiftStars',\n      months,\n      message,\n      user,\n    };\n  }\n\n  if (inputInvoice.type === 'giftcode') {\n    const {\n      userIds, boostChannelId, amount, currency, option, message,\n    } = inputInvoice;\n    const users = userIds.map((id) => selectUser(global, id)).filter(Boolean);\n    const boostChannel = boostChannelId ? selectChat(global, boostChannelId) : undefined;\n\n    return {\n      type: 'giveaway',\n      option,\n      purpose: {\n        type: 'giftcode',\n        amount,\n        currency,\n        users,\n        boostChannel,\n        message,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'starsgiveaway') {\n    const {\n      chatId, additionalChannelIds, amount, currency, untilDate, areWinnersVisible, countries,\n      isOnlyForNewSubscribers, prizeDescription, stars, users,\n    } = inputInvoice;\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return undefined;\n    }\n    const additionalChannels = additionalChannelIds?.map((id) => selectChat(global, id)).filter(Boolean);\n\n    return {\n      type: 'starsgiveaway',\n      purpose: {\n        type: 'starsgiveaway',\n        amount,\n        currency,\n        chat,\n        additionalChannels,\n        untilDate,\n        areWinnersVisible,\n        countries,\n        isOnlyForNewSubscribers,\n        prizeDescription,\n        stars,\n        users,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'giveaway') {\n    const {\n      chatId, additionalChannelIds, amount, currency, option, untilDate, areWinnersVisible, countries,\n      isOnlyForNewSubscribers, prizeDescription,\n    } = inputInvoice;\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return undefined;\n    }\n    const additionalChannels = additionalChannelIds?.map((id) => selectChat(global, id)).filter(Boolean);\n\n    return {\n      type: 'giveaway',\n      option,\n      purpose: {\n        type: 'giveaway',\n        amount,\n        currency,\n        chat,\n        additionalChannels,\n        untilDate,\n        areWinnersVisible,\n        countries,\n        isOnlyForNewSubscribers,\n        prizeDescription,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftUpgrade') {\n    const { inputSavedGift, shouldKeepOriginalDetails } = inputInvoice;\n    const savedGift = getRequestInputSavedStarGift(global, inputSavedGift);\n    if (!savedGift) return undefined;\n\n    return {\n      type: 'stargiftUpgrade',\n      inputSavedGift: savedGift,\n      shouldKeepOriginalDetails,\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftTransfer') {\n    const { inputSavedGift, recipientId } = inputInvoice;\n    const savedGift = getRequestInputSavedStarGift(global, inputSavedGift);\n    const peer = selectPeer(global, recipientId);\n    if (!savedGift || !peer) return undefined;\n\n    return {\n      type: 'stargiftTransfer',\n      inputSavedGift: savedGift,\n      recipient: peer,\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftDropOriginalDetails') {\n    const { inputSavedGift } = inputInvoice;\n    const savedGift = getRequestInputSavedStarGift(global, inputSavedGift);\n    if (!savedGift) return undefined;\n\n    return {\n      type: 'stargiftDropOriginalDetails',\n      inputSavedGift: savedGift,\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftPrepaidUpgrade') {\n    const { peerId, hash } = inputInvoice;\n    const peer = selectPeer(global, peerId);\n    if (!peer) return undefined;\n\n    return {\n      type: 'stargiftPrepaidUpgrade',\n      peer,\n      hash,\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftAuctionBid') {\n    const {\n      giftId, bidAmount, peerId, message, shouldHideName, isUpdateBid,\n    } = inputInvoice;\n    const peer = peerId ? selectPeer(global, peerId) : undefined;\n\n    return {\n      type: 'stargiftAuctionBid',\n      giftId,\n      bidAmount,\n      peer,\n      message,\n      shouldHideName,\n      isUpdateBid,\n    };\n  }\n\n  return undefined;\n}\n\nexport function getRequestInputSavedStarGift<T extends GlobalState>(\n  global: T, inputGift: ApiInputSavedStarGift,\n): ApiRequestInputSavedStarGift | undefined {\n  if (inputGift.type === 'user') return inputGift;\n\n  if (inputGift.type === 'chat') {\n    const chat = selectChat(global, inputGift.chatId);\n    if (!chat) return undefined;\n\n    return {\n      type: 'chat',\n      chat,\n      savedId: inputGift.savedId,\n    };\n  }\n\n  return undefined;\n}\n\nexport function shouldUseCustomPeer(transaction: ApiStarsTransaction) {\n  return transaction.peer.type !== 'peer' || Boolean(transaction.isPostsSearch);\n}\n\nexport function buildStarsTransactionCustomPeer(\n  transaction: ApiStarsTransaction,\n): CustomPeer {\n  const { peer } = transaction;\n  const isForTon = transaction.amount.currency === TON_CURRENCY_CODE;\n\n  if (transaction.isPostsSearch) {\n    return {\n      avatarIcon: 'search',\n      isCustomPeer: true,\n      title: '',\n      peerColorId: 5,\n    };\n  }\n\n  if (peer.type === 'appStore') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.AppleTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.AppleTopUp.Subtitle',\n      peerColorId: 5,\n    };\n  }\n\n  if (peer.type === 'playMarket') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.GoogleTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.GoogleTopUp.Subtitle',\n      peerColorId: 3,\n    };\n  }\n\n  if (peer.type === 'fragment') {\n    if (isForTon) {\n      return {\n        avatarIcon: 'fragment',\n        isCustomPeer: true,\n        titleKey: 'Stars.Gift.Received.Title',\n        subtitleKey: 'Stars.Intro.Transaction.Gift.UnknownUser',\n        customPeerAvatarColor: '#000000',\n      };\n    }\n    return {\n      avatarIcon: 'fragment',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.FragmentTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.FragmentTopUp.Subtitle',\n      customPeerAvatarColor: '#000000',\n    };\n  }\n\n  if (peer.type === 'premiumBot') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.PremiumBotTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.PremiumBotTopUp.Subtitle',\n      peerColorId: 1,\n      withPremiumGradient: true,\n    };\n  }\n\n  if (peer.type === 'ads') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.TelegramAds.Title',\n      subtitleKey: 'Stars.Intro.Transaction.TelegramAds.Subtitle',\n      peerColorId: 2,\n    };\n  }\n\n  if (peer.type === 'api') {\n    return {\n      avatarIcon: 'bots',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.TelegramBotApi.Title',\n      subtitleKey: 'Stars.Intro.Transaction.TelegramBotApi.Subtitle',\n      peerColorId: 4,\n    };\n  }\n\n  return {\n    avatarIcon: 'star',\n    isCustomPeer: true,\n    titleKey: 'Stars.Intro.Transaction.Unsupported.Title',\n    subtitleKey: 'Stars.Intro.Transaction.Unsupported.Title',\n    peerColorId: 0,\n  };\n}\n\nexport function formatStarsTransactionAmount(lang: LangFn, currencyAmount: ApiTypeCurrencyAmount) {\n  if (currencyAmount.currency === STARS_CURRENCY_CODE) {\n    const amount = currencyAmount.amount + currencyAmount.nanos / 1e9;\n    if (amount < 0) {\n      return `- ${lang.number(Math.abs(amount))}`;\n    }\n\n    return `+ ${lang.number(amount)}`;\n  }\n\n  if (currencyAmount.currency === TON_CURRENCY_CODE) {\n    const amount = convertTonFromNanos(currencyAmount.amount);\n    const absAmount = Math.abs(amount);\n\n    if (amount < 0) {\n      return `- ${lang.preciseNumber(absAmount)}`;\n    }\n\n    return `+ ${lang.preciseNumber(absAmount)}`;\n  }\n\n  return undefined;\n}\n\nexport function formatStarsAmount(lang: LangFn, starsAmount: ApiStarsAmount) {\n  return lang.number(starsAmount.amount + starsAmount.nanos / 1e9);\n}\n\nexport function getStarsTransactionFromGift(message: ApiMessage): ApiStarsTransaction | undefined {\n  const { action } = message.content;\n\n  if (action?.type === 'giftStars') {\n    const { transactionId, stars } = action;\n\n    return {\n      id: transactionId,\n      amount: {\n        currency: STARS_CURRENCY_CODE,\n        amount: stars,\n        nanos: 0,\n      },\n      peer: {\n        type: 'peer',\n        id: message.isOutgoing ? message.chatId : (message.senderId || message.chatId),\n      },\n      date: message.date,\n      isGift: true,\n      isMyGift: message.isOutgoing || undefined,\n    };\n  }\n\n  if (action?.type === 'giftTon') {\n    const { transactionId, cryptoAmount } = action;\n\n    return {\n      id: transactionId,\n      amount: {\n        currency: TON_CURRENCY_CODE,\n        amount: cryptoAmount,\n      },\n      peer: {\n        type: 'fragment',\n      },\n      date: message.date,\n      isGift: true,\n      isMyGift: message.isOutgoing || undefined,\n    };\n  }\n\n  return undefined;\n}\n\nexport function getPrizeStarsTransactionFromGiveaway(message: ApiMessage): ApiStarsTransaction | undefined {\n  const { action } = message.content;\n\n  if (action?.type !== 'prizeStars') return undefined;\n\n  const { transactionId, stars, boostPeerId } = action;\n\n  return {\n    id: transactionId,\n    amount: {\n      currency: STARS_CURRENCY_CODE,\n      amount: stars,\n      nanos: 0,\n    },\n    peer: {\n      type: 'peer',\n      id: boostPeerId,\n    },\n    date: message.date,\n    giveawayPostId: message.id,\n  };\n}\n\nexport function areInputSavedGiftsEqual(one: ApiInputSavedStarGift, two: ApiInputSavedStarGift) {\n  return arePropsShallowEqual(one, two);\n}\n","import type { ElementRef } from '../lib/teact/teact';\nimport { useEffect, useState } from '../lib/teact/teact';\nimport { addExtraClass, removeExtraClass } from '../lib/teact/teact-dom';\n\nimport type { IAnchorPosition } from '../types';\nimport type { Signal } from '../util/signals';\n\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS, IS_PWA, IS_TOUCH_ENV } from '../util/browser/windowEnvironment';\nimport useLastCallback from './useLastCallback';\n\nconst LONG_TAP_DURATION_MS = 200;\nconst IOS_PWA_CONTEXT_MENU_DELAY_MS = 100;\n\nfunction stopEvent(e: Event) {\n  e.stopImmediatePropagation();\n  e.preventDefault();\n  e.stopPropagation();\n}\n\nconst useContextMenuHandlers = (\n  elementRef: ElementRef<HTMLElement>,\n  isMenuDisabled?: boolean,\n  shouldDisableOnLink?: boolean,\n  shouldDisableOnLongTap?: boolean,\n  getIsReady?: Signal<boolean>,\n  shouldDisablePropagation?: boolean,\n) => {\n  const [isContextMenuOpen, setIsContextMenuOpen] = useState(false);\n  const [contextMenuAnchor, setContextMenuAnchor] = useState<IAnchorPosition | undefined>(undefined);\n  const [contextMenuTarget, setContextMenuTarget] = useState<HTMLElement | undefined>(undefined);\n\n  const handleBeforeContextMenu = useLastCallback((e: React.MouseEvent) => {\n    if (!isMenuDisabled && e.button === 2) {\n      requestMutation(() => {\n        addExtraClass(e.target as HTMLElement, 'no-selection');\n      });\n    }\n  });\n\n  const handleContextMenu = useLastCallback((e: React.MouseEvent) => {\n    requestMutation(() => {\n      removeExtraClass(e.target as HTMLElement, 'no-selection');\n    });\n\n    if (isMenuDisabled || (shouldDisableOnLink && (e.target as HTMLElement).matches('a[href]'))) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (contextMenuAnchor) {\n      return;\n    }\n\n    setIsContextMenuOpen(true);\n    setContextMenuAnchor({ x: e.clientX, y: e.clientY });\n    setContextMenuTarget(e.target as HTMLElement);\n  });\n\n  const handleContextMenuClose = useLastCallback(() => {\n    setIsContextMenuOpen(false);\n  });\n\n  const handleContextMenuHide = useLastCallback(() => {\n    setContextMenuAnchor(undefined);\n  });\n\n  // Support context menu on touch devices\n  useEffect(() => {\n    if (isMenuDisabled || !IS_TOUCH_ENV || shouldDisableOnLongTap || (getIsReady && !getIsReady())) {\n      return undefined;\n    }\n\n    const element = elementRef.current;\n    if (!element) {\n      return undefined;\n    }\n\n    let timer: number | undefined;\n\n    const clearLongPressTimer = () => {\n      if (timer) {\n        clearTimeout(timer);\n        timer = undefined;\n      }\n    };\n\n    const emulateContextMenuEvent = (originalEvent: TouchEvent) => {\n      clearLongPressTimer();\n\n      const { clientX, clientY, target } = originalEvent.touches[0];\n\n      if (contextMenuAnchor || (shouldDisableOnLink && (target as HTMLElement).matches('a[href]'))) {\n        return;\n      }\n\n      // Temporarily intercept and clear the next click\n      document.addEventListener('touchend', (e) => {\n        // On iOS in PWA mode, the context menu may cause click-through to the element in the menu upon opening\n        if (IS_IOS && IS_PWA) {\n          setTimeout(() => {\n            document.removeEventListener('mousedown', stopEvent, {\n              capture: true,\n            });\n            document.removeEventListener('click', stopEvent, {\n              capture: true,\n            });\n          }, IOS_PWA_CONTEXT_MENU_DELAY_MS);\n        }\n        stopEvent(e);\n      }, {\n        once: true,\n        capture: true,\n      });\n\n      // On iOS15, in PWA mode, the context menu immediately closes after opening\n      if (IS_PWA && IS_IOS) {\n        document.addEventListener('mousedown', stopEvent, {\n          once: true,\n          capture: true,\n        });\n        document.addEventListener('click', stopEvent, {\n          once: true,\n          capture: true,\n        });\n      }\n\n      setIsContextMenuOpen(true);\n      setContextMenuAnchor({ x: clientX, y: clientY });\n    };\n\n    const startLongPressTimer = (e: TouchEvent) => {\n      if (isMenuDisabled) {\n        return;\n      }\n      if (shouldDisablePropagation) e.stopPropagation();\n      clearLongPressTimer();\n\n      timer = window.setTimeout(() => emulateContextMenuEvent(e), LONG_TAP_DURATION_MS);\n    };\n\n    // @perf Consider event delegation\n    element.addEventListener('touchstart', startLongPressTimer, { passive: true });\n    element.addEventListener('touchcancel', clearLongPressTimer, true);\n    element.addEventListener('touchend', clearLongPressTimer, true);\n    element.addEventListener('touchmove', clearLongPressTimer, { passive: true });\n\n    return () => {\n      clearLongPressTimer();\n      element.removeEventListener('touchstart', startLongPressTimer);\n      element.removeEventListener('touchcancel', clearLongPressTimer, true);\n      element.removeEventListener('touchend', clearLongPressTimer, true);\n      element.removeEventListener('touchmove', clearLongPressTimer);\n    };\n  }, [\n    contextMenuAnchor, isMenuDisabled, shouldDisableOnLongTap, elementRef, shouldDisableOnLink, getIsReady,\n    shouldDisablePropagation,\n  ]);\n\n  return {\n    isContextMenuOpen,\n    contextMenuAnchor,\n    contextMenuTarget,\n    handleBeforeContextMenu,\n    handleContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  };\n};\n\nexport default useContextMenuHandlers;\n","import { useLayoutEffect, useRef } from '../lib/teact/teact';\n\nconst useLayoutEffectWithPrevDeps = <const T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T, debugKey?: string,\n) => {\n  const prevDepsRef = useRef<T>();\n\n  return useLayoutEffect(() => {\n    const prevDeps = prevDepsRef.current;\n    prevDepsRef.current = dependencies;\n\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies, debugKey);\n};\n\nexport default useLayoutEffectWithPrevDeps;\n","let counter = 0;\n\nexport function disableDirectTextInput() {\n  counter += 1;\n}\n\nexport function enableDirectTextInput() {\n  counter -= 1;\n}\n\nexport function getIsDirectTextInputDisabled() {\n  return counter > 0;\n}\n","export default function trapFocus(element: HTMLElement) {\n  function handleKeyDown(e: KeyboardEvent) {\n    if (e.key !== 'Tab') {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    const focusableElements = Array.from(\n      element.querySelectorAll<HTMLElement>('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'),\n    );\n    if (!focusableElements.length) {\n      return;\n    }\n\n    const currentFocusedIndex = focusableElements.findIndex((em) => em.isSameNode(document.activeElement));\n    let newFocusedIndex = 0;\n    if (currentFocusedIndex >= 0) {\n      if (e.shiftKey) {\n        newFocusedIndex = currentFocusedIndex > 0\n          ? currentFocusedIndex - 1\n          : focusableElements.length - 1;\n      } else {\n        newFocusedIndex = currentFocusedIndex < focusableElements.length - 1\n          ? currentFocusedIndex + 1\n          : 0;\n      }\n    }\n\n    focusableElements[newFocusedIndex].focus();\n  }\n\n  document.addEventListener('keydown', handleKeyDown, false);\n\n  return () => {\n    document.removeEventListener('keydown', handleKeyDown, false);\n  };\n}\n"],"names":["STARS_CURRENCY_CODE","TON_CURRENCY_CODE","arePropsShallowEqual","convertTonFromNanos","selectChat","selectPeer","selectUser","getRequestInputInvoice","global","inputInvoice","type","slug","peerId","peer","undefined","currency","shouldHideName","giftId","message","shouldUpgrade","userId","stars","amount","user","purpose","spendPurposePeerId","spendPurposePeer","hash","chat","chatId","messageId","months","userIds","boostChannelId","option","users","map","id","filter","Boolean","boostChannel","additionalChannelIds","untilDate","areWinnersVisible","countries","isOnlyForNewSubscribers","prizeDescription","additionalChannels","inputSavedGift","shouldKeepOriginalDetails","savedGift","getRequestInputSavedStarGift","recipientId","recipient","bidAmount","isUpdateBid","inputGift","savedId","shouldUseCustomPeer","transaction","isPostsSearch","buildStarsTransactionCustomPeer","isForTon","avatarIcon","isCustomPeer","title","peerColorId","titleKey","subtitleKey","customPeerAvatarColor","withPremiumGradient","formatStarsTransactionAmount","lang","currencyAmount","nanos","number","Math","abs","absAmount","preciseNumber","formatStarsAmount","starsAmount","getStarsTransactionFromGift","action","content","transactionId","isOutgoing","senderId","date","isGift","isMyGift","cryptoAmount","getPrizeStarsTransactionFromGiveaway","boostPeerId","giveawayPostId","areInputSavedGiftsEqual","one","two","useEffect","useState","addExtraClass","removeExtraClass","requestMutation","IS_IOS","IS_PWA","IS_TOUCH_ENV","useLastCallback","LONG_TAP_DURATION_MS","IOS_PWA_CONTEXT_MENU_DELAY_MS","stopEvent","e","stopImmediatePropagation","preventDefault","stopPropagation","useContextMenuHandlers","elementRef","isMenuDisabled","shouldDisableOnLink","shouldDisableOnLongTap","getIsReady","shouldDisablePropagation","isContextMenuOpen","setIsContextMenuOpen","contextMenuAnchor","setContextMenuAnchor","contextMenuTarget","setContextMenuTarget","handleBeforeContextMenu","button","target","handleContextMenu","matches","x","clientX","y","clientY","handleContextMenuClose","handleContextMenuHide","element","current","timer","clearLongPressTimer","clearTimeout","emulateContextMenuEvent","originalEvent","touches","document","addEventListener","setTimeout","removeEventListener","capture","once","startLongPressTimer","window","passive","useLayoutEffect","useRef","useLayoutEffectWithPrevDeps","cb","dependencies","debugKey","prevDepsRef","prevDeps","counter","disableDirectTextInput","enableDirectTextInput","getIsDirectTextInputDisabled","trapFocus","handleKeyDown","key","focusableElements","Array","from","querySelectorAll","length","currentFocusedIndex","findIndex","em","isSameNode","activeElement","newFocusedIndex","shiftKey","focus"],"sourceRoot":""}